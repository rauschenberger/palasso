<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sparse regression with paired covariates â€¢ palasso</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Sparse regression with paired covariates">
<meta property="og:description" content="palasso">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">palasso</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">functions</a>
</li>
<li>
  <a href="../articles/vignette.html">vignette</a>
</li>
<li>
  <a href="../articles/article.html">article</a>
</li>
<li>
  <a href="../articles/script.html">script</a>
</li>
<li>
  <a href="../news/index.html">news</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rauschenberger/palasso">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://cran.r-project.org/package=palasso">
    <span class="fa fa-download"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Sparse regression with paired covariates</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rauschenberger/palasso/blob/master/vignettes/script.Rmd"><code>vignettes/script.Rmd</code></a></small>
      <div class="hidden name"><code>script.Rmd</code></div>

    </div>

    
    
<p>Code for reproducing the results shown in the manuscript.</p>
<div id="initialisation" class="section level1">
<h1 class="hasAnchor">
<a href="#initialisation" class="anchor"></a>Initialisation</h1>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co">### Loading functions. ###</span>

<span class="no">inst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="kw pkg">utils</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span>())

<span class="no">cran</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"devtools"</span>,<span class="st">"R.utils"</span>,<span class="st">"Matrix"</span>,<span class="st">"glmnet"</span>,<span class="st">"pROC"</span>,<span class="st">"BiocManager"</span>,<span class="st">"ashr"</span>)
<span class="co"># "googledrive", "httpuv"</span>
<span class="kw">if</span>(!<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span>(<span class="no">cran</span> <span class="kw">%in%</span> <span class="no">inst</span>)){
    <span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">cran</span>)){
        <span class="kw">if</span>(!<span class="no">cran</span>[<span class="no">i</span>] <span class="kw">%in%</span> <span class="no">inst</span>){
            <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="no">cran</span>[<span class="no">i</span>])
        }
    }
}

<span class="no">bioc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"edgeR"</span>,<span class="st">"TCGAbiolinks"</span>)
<span class="kw">if</span>(!<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span>(<span class="no">bioc</span> <span class="kw">%in%</span> <span class="no">inst</span>)){
    <span class="co">#source("http://bioconductor.org/biocLite.R")</span>
    <span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">bioc</span>)){
        <span class="kw">if</span>(!<span class="no">bioc</span>[<span class="no">i</span>] <span class="kw">%in%</span> <span class="no">inst</span>){
            <span class="co">#biocLite(bioc[i])</span>
            <span class="kw pkg">BiocManager</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span>(<span class="no">bioc</span>[<span class="no">i</span>])
        }
    }
}

<span class="co">#if(!"ashr" %in% inst){</span>
<span class="co">#  devtools::install_github("stephens999/ashr")</span>
<span class="co">#}</span>

<span class="no">user</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span>(<span class="st">"USERNAME"</span>)
<span class="no">path</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="st">"C:"</span>,<span class="st">"Users"</span>,<span class="no">user</span>,<span class="st">"Desktop"</span>,<span class="st">"palasso"</span>)
<span class="kw">if</span>(<span class="no">user</span><span class="kw">==</span><span class="st">"arra"</span>){<span class="no">path</span> <span class="kw">&lt;-</span> <span class="st">"C:/Users/arra/Desktop/MATHS/palasso_desktop"</span>}
<span class="kw">if</span>(<span class="no">user</span><span class="kw">==</span><span class="st">""</span>){<span class="no">path</span> <span class="kw">&lt;-</span> <span class="st">"/virdir/Scratch/arauschenberger/palasso"</span>}
<span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span>(<span class="no">path</span>)
<span class="no">folders</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"data"</span>,<span class="st">"results"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">folders</span>,<span class="kw">function</span>(<span class="no">x</span>) <span class="kw">if</span>(!<span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.exists</a></span>(<span class="no">x</span>)){<span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span>(<span class="no">x</span>)}))

<span class="kw">if</span>(<span class="no">user</span><span class="kw">!=</span><span class="st">"arra"</span>){
    <span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"kkdey/CorShrink"</span>) <span class="co"># ref="a9f6ba0"</span>
    <span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"rauschenberger/palasso"</span>) <span class="co"># ref="4a995a2"</span>
}

<span class="kw">if</span>(<span class="fl">FALSE</span>){

    <span class="co"># The functions &lt;&lt;save&gt;&gt;, &lt;&lt;file.exists&gt;&gt; and &lt;&lt;file.remove&gt;&gt; access the hard disk, but also try to access googledrive.</span>

    <span class="no">save</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">object</span>,<span class="no">file</span>){
        <span class="kw pkg">base</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="no">object</span>,<span class="kw">file</span><span class="kw">=</span><span class="no">file</span>)
        <span class="fu"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span>(<span class="kw">expr</span><span class="kw">=</span><span class="kw pkg">googledrive</span><span class="kw ns">::</span><span class="fu">drive_upload</span>(<span class="kw">media</span><span class="kw">=</span><span class="no">file</span>,<span class="kw">path</span><span class="kw">=</span><span class="no">file</span>),
                 <span class="kw">error</span><span class="kw">=</span><span class="kw">function</span>(<span class="no">x</span>) <span class="kw">NULL</span>)
        <span class="co">#Sys.sleep(0.5)</span>
    }

    <span class="no">file.exists</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">file</span>){
        <span class="no">offline</span> <span class="kw">&lt;-</span> <span class="kw pkg">base</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span>(<span class="no">file</span>)
        <span class="no">online</span> <span class="kw">&lt;-</span> <span class="fl">FALSE</span>
        <span class="kw">if</span>(!<span class="no">offline</span>){
            <span class="no">d</span> <span class="kw">&lt;-</span> <span class="kw pkg">googledrive</span><span class="kw ns">::</span><span class="fu">as_dribble</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">file</span>)
            <span class="no">online</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span>(<span class="kw">expr</span><span class="kw">=</span><span class="kw pkg">googledrive</span><span class="kw ns">::</span><span class="fu">some_files</span>(<span class="no">d</span>),
                               <span class="kw">error</span><span class="kw">=</span><span class="kw">function</span>(<span class="no">x</span>) <span class="fl">FALSE</span>)
            <span class="co">#Sys.sleep(0.5)</span>
        }
        <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">offline</span><span class="kw">|</span><span class="no">online</span>)
    }

    <span class="no">file.remove</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">file</span>){
        <span class="kw pkg">base</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.remove</a></span>(<span class="no">file</span>)
        <span class="fu"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span>(<span class="kw">expr</span><span class="kw">=</span><span class="kw pkg">googledrive</span><span class="kw ns">::</span><span class="fu">drive_trash</span>(<span class="kw">file</span><span class="kw">=</span><span class="no">file</span>),
             <span class="kw">error</span><span class="kw">=</span><span class="kw">function</span>(<span class="no">x</span>) <span class="kw">NULL</span>)
        <span class="co">#Sys.sleep(0.5)</span>
    }


<span class="co"># The function &lt;&lt;update&gt;&gt; moves files from the research cloud to the remote drive. Given both paths, it first verifies whether the folders SIM, GDC and CCA are available, and then copies all missing files from the research cloud to the remote drive.</span>

<span class="co"># from: path to the origin</span>
<span class="co"># to: path to the destination</span>

<span class="no">update</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">from</span>,<span class="no">to</span>){
    <span class="no">dir</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"SIM"</span>,<span class="st">"GDC"</span>,<span class="st">"CCA"</span>)
    <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span>(!<span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.exists</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">from</span>,<span class="no">dir</span>)))){<span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"Invalid."</span>)}
    <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span>(!<span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.exists</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">to</span>,<span class="no">dir</span>)))){<span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"Invalid."</span>)}
    <span class="no">pb</span> <span class="kw">&lt;-</span> <span class="kw pkg">utils</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/utils/txtProgressBar.html">txtProgressBar</a></span>(<span class="kw">min</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">max</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">style</span><span class="kw">=</span><span class="fl">3</span>)
    <span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">dir</span>)){
        <span class="no">files0</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">from</span>,<span class="no">dir</span>[<span class="no">i</span>]))
        <span class="no">files1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">to</span>,<span class="no">dir</span>[<span class="no">i</span>]))
        <span class="no">names</span> <span class="kw">&lt;-</span> <span class="no">files0</span>[!<span class="no">files0</span> <span class="kw">%in%</span> <span class="no">files1</span>]
        <span class="kw">for</span>(<span class="no">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">names</span>)){
            <span class="kw pkg">utils</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/utils/txtProgressBar.html">setTxtProgressBar</a></span>(<span class="kw">pb</span><span class="kw">=</span><span class="no">pb</span>,<span class="kw">value</span><span class="kw">=</span>(<span class="no">i</span>-<span class="fl">1</span>)/<span class="fl">3</span>+(<span class="no">j</span>*<span class="no">i</span>)/(<span class="fl">3</span>*<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">names</span>)))
            <span class="fu"><a href="https://rdrr.io/r/base/files.html">file.copy</a></span>(<span class="kw">from</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">from</span>,<span class="no">dir</span>[<span class="no">i</span>],<span class="no">names</span>[<span class="no">j</span>]),
                      <span class="kw">to</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">to</span>,<span class="no">dir</span>[<span class="no">i</span>],<span class="no">names</span>[<span class="no">j</span>]),
                      <span class="kw">copy.date</span><span class="kw">=</span><span class="fl">TRUE</span>)
        }
        <span class="kw pkg">utils</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/utils/txtProgressBar.html">setTxtProgressBar</a></span>(<span class="kw">pb</span><span class="kw">=</span><span class="no">pb</span>,<span class="kw">value</span><span class="kw">=</span><span class="no">i</span>/<span class="fl">3</span>)
    }
}

<span class="co"># update(from="results",to="//tsclient/N/palasso/results")</span>

}</pre></body></html></div>
</div>
<div id="preparation" class="section level1">
<h1 class="hasAnchor">
<a href="#preparation" class="anchor"></a>Preparation</h1>
<p>Last data download started on 2019-03-26 (R version 3.5.3).</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co">### Downloading "Isoform Expression Quantification". ###</span>

<span class="co">#rm(list=ls())</span>
<span class="co">#&lt;&lt;functions&gt;&gt;</span>

<span class="no">directory</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">path</span>,<span class="st">"data"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span>(<span class="no">directory</span>)

<span class="co"># Retrieving cancer types:</span>
<span class="no">project</span> <span class="kw">&lt;-</span> <span class="kw pkg">TCGAbiolinks</span><span class="kw ns">::</span><span class="fu">getGDCprojects</span>()$<span class="no">id</span>
<span class="no">project</span> <span class="kw">&lt;-</span> <span class="no">project</span>[<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">project</span>,<span class="kw">pattern</span><span class="kw">=</span><span class="st">"TCGA"</span>)]

<span class="co"># Downloading isoform expression data:</span>
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="no">X</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">project</span>)){
    <span class="no">query</span> <span class="kw">&lt;-</span> <span class="kw pkg">TCGAbiolinks</span><span class="kw ns">::</span><span class="fu">GDCquery</span>(<span class="kw">project</span><span class="kw">=</span><span class="no">project</span>[<span class="no">i</span>],
                <span class="kw">data.category</span><span class="kw">=</span><span class="st">"Transcriptome Profiling"</span>,
                <span class="kw">data.type</span><span class="kw">=</span><span class="st">"Isoform Expression Quantification"</span>)
    <span class="kw pkg">TCGAbiolinks</span><span class="kw ns">::</span><span class="fu">GDCdownload</span>(<span class="no">query</span>,<span class="kw">method</span><span class="kw">=</span><span class="st">"api"</span>,<span class="kw">directory</span><span class="kw">=</span><span class="no">directory</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/trace.html">trace</a></span>(<span class="kw pkg">TCGAbiolinks</span><span class="kw ns">:::</span><span class="no">readTranscriptomeProfiling</span>,<span class="kw">tracer</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span>(<span class="no">ignore.case</span><span class="kw">&lt;-</span><span class="fl">TRUE</span>))
    <span class="no">X</span><span class="kw">[[</span><span class="no">i</span>]] <span class="kw">&lt;-</span> <span class="kw pkg">TCGAbiolinks</span><span class="kw ns">::</span><span class="fu">GDCprepare</span>(<span class="no">query</span>,<span class="kw">directory</span><span class="kw">=</span><span class="no">directory</span>)
    <span class="no">X</span><span class="kw">[[</span><span class="no">i</span>]][,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"miRNA_ID"</span>,<span class="st">"reads_per_million_miRNA_mapped"</span>,
              <span class="st">"cross-mapped"</span>,<span class="st">"miRNA_region"</span>)] <span class="kw">&lt;-</span> <span class="kw">NULL</span>
    <span class="no">y</span><span class="kw">[[</span><span class="no">i</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">project</span>[<span class="no">i</span>],<span class="kw">times</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">X</span><span class="kw">[[</span><span class="no">i</span>]]$<span class="no">barcode</span>)))
}

<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="kw">list</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"y"</span>,<span class="st">"X"</span>),<span class="kw">file</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">path</span>,<span class="st">"data"</span>,<span class="st">"isoform_raw.RData"</span>))
<span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">path</span>,<span class="st">"data"</span>,<span class="st">"isoform_raw.RData"</span>),<span class="kw">verbose</span><span class="kw">=</span><span class="fl">TRUE</span>)

<span class="co"># Merging isoform expression data:</span>
<span class="no">Xs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="kw">what</span><span class="kw">=</span><span class="no">rbind</span>,<span class="kw">args</span><span class="kw">=</span><span class="no">X</span>) <span class="co"># sparse matrix</span>
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="kw">what</span><span class="kw">=</span><span class="st">"c"</span>,<span class="kw">args</span><span class="kw">=</span><span class="no">y</span>)

<span class="co"># Transform to matrix</span>
<span class="no">Xs</span>$<span class="no">isoform_coords</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="kw">pattern</span><span class="kw">=</span><span class="st">"hg38:chr"</span>,<span class="kw">replacement</span><span class="kw">=</span><span class="st">""</span>,<span class="kw">x</span><span class="kw">=</span><span class="no">Xs</span>$<span class="no">isoform_coords</span>)
<span class="no">samples</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">Xs</span>$<span class="no">barcode</span>)
<span class="no">covariates</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">Xs</span>$<span class="no">isoform_coords</span>)
<span class="no">row</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span>(<span class="no">Xs</span>$<span class="no">barcode</span>,<span class="no">samples</span>)
<span class="no">col</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span>(<span class="no">Xs</span>$<span class="no">isoform_coords</span>,<span class="no">covariates</span>)
<span class="no">X</span> <span class="kw">&lt;-</span> <span class="kw pkg">Matrix</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/sparseMatrix.html">sparseMatrix</a></span>(<span class="kw">i</span><span class="kw">=</span><span class="no">row</span>,<span class="kw">j</span><span class="kw">=</span><span class="no">col</span>,<span class="kw">x</span><span class="kw">=</span><span class="no">Xs</span>$<span class="no">read_count</span>,<span class="kw">dimnames</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">samples</span>,<span class="no">covariates</span>))

<span class="co"># Order by molecular location</span>
<span class="no">split</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">X</span>),<span class="kw">split</span><span class="kw">=</span><span class="st">":|-"</span>)
<span class="no">chr</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">split</span>,<span class="kw">function</span>(<span class="no">x</span>) <span class="no">x</span><span class="kw">[[</span><span class="fl">1</span>]])
<span class="no">pos</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">split</span>,<span class="kw">function</span>(<span class="no">x</span>) <span class="no">x</span><span class="kw">[[</span><span class="fl">2</span>]])
<span class="no">order</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span>(<span class="no">chr</span>,<span class="no">pos</span>)
<span class="no">X</span> <span class="kw">&lt;-</span> <span class="no">X</span>[,<span class="no">order</span>]

<span class="kw">if</span>(<span class="fl">FALSE</span>){ <span class="co"># testing</span>
    <span class="no">i</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">Xs</span>)),<span class="kw">size</span><span class="kw">=</span><span class="fl">1</span>)
    <span class="no">Xs</span>$<span class="no">read_count</span>[<span class="no">i</span>]
    <span class="no">X</span>[<span class="no">Xs</span>$<span class="no">barcode</span>[<span class="no">i</span>],<span class="no">Xs</span>$<span class="no">isoform_coords</span>[<span class="no">i</span>]]
}

<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="kw">list</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"y"</span>,<span class="st">"X"</span>),<span class="kw">file</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">path</span>,<span class="st">"data"</span>,<span class="st">"isoform_all.RData"</span>))</pre></body></html></div>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co">### Downloading "miRNA Expression Quantification". ###</span>

<span class="co">#rm(list=ls())</span>
<span class="co">#&lt;&lt;functions&gt;&gt;</span>

<span class="no">directory</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">path</span>,<span class="st">"data"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span>(<span class="no">directory</span>)

<span class="co"># Downloading data.</span>
<span class="no">project</span> <span class="kw">&lt;-</span> <span class="kw pkg">TCGAbiolinks</span><span class="kw ns">::</span><span class="fu">getGDCprojects</span>()$<span class="no">id</span>
<span class="no">project</span> <span class="kw">&lt;-</span> <span class="no">project</span>[<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">project</span>,<span class="kw">pattern</span><span class="kw">=</span><span class="st">"TCGA"</span>)]
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="no">X</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">project</span>)){
    <span class="no">query</span> <span class="kw">&lt;-</span> <span class="kw pkg">TCGAbiolinks</span><span class="kw ns">::</span><span class="fu">GDCquery</span>(<span class="kw">project</span><span class="kw">=</span><span class="no">project</span>[<span class="no">i</span>],
                           <span class="kw">data.category</span><span class="kw">=</span><span class="st">"Transcriptome Profiling"</span>,
                           <span class="kw">data.type</span><span class="kw">=</span><span class="st">"miRNA Expression Quantification"</span>)
    <span class="kw pkg">TCGAbiolinks</span><span class="kw ns">::</span><span class="fu">GDCdownload</span>(<span class="no">query</span>,<span class="kw">method</span><span class="kw">=</span><span class="st">"api"</span>,<span class="kw">directory</span><span class="kw">=</span><span class="no">directory</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/trace.html">trace</a></span>(<span class="kw pkg">TCGAbiolinks</span><span class="kw ns">:::</span><span class="no">readTranscriptomeProfiling</span>,<span class="kw">tracer</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span>(<span class="no">ignore.case</span><span class="kw">&lt;-</span><span class="fl">TRUE</span>))
    <span class="no">data</span> <span class="kw">&lt;-</span> <span class="kw pkg">TCGAbiolinks</span><span class="kw ns">::</span><span class="fu">GDCprepare</span>(<span class="no">query</span>,<span class="kw">directory</span><span class="kw">=</span><span class="no">directory</span>)
    <span class="no">X</span><span class="kw">[[</span><span class="no">i</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">data</span>[,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">to</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">data</span>),<span class="kw">by</span><span class="kw">=</span><span class="fl">3</span>))])
    <span class="no">y</span><span class="kw">[[</span><span class="no">i</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">project</span>[<span class="no">i</span>],<span class="kw">times</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">X</span><span class="kw">[[</span><span class="no">i</span>]]))
}

<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="kw">list</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"y"</span>,<span class="st">"X"</span>),<span class="kw">file</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">path</span>,<span class="st">"data"</span>,<span class="st">"miRNA_raw.RData"</span>))
<span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">path</span>,<span class="st">"data"</span>,<span class="st">"miRNA_raw.RData"</span>))

<span class="no">X</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="kw">what</span><span class="kw">=</span><span class="no">rbind</span>,<span class="kw">args</span><span class="kw">=</span><span class="no">X</span>)
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="kw">what</span><span class="kw">=</span><span class="st">"c"</span>,<span class="kw">args</span><span class="kw">=</span><span class="no">y</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">X</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="kw">pattern</span><span class="kw">=</span><span class="st">"read_count_"</span>,<span class="kw">replacement</span><span class="kw">=</span><span class="st">""</span>,<span class="kw">x</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">X</span>))

<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="kw">list</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"y"</span>,<span class="st">"X"</span>),<span class="kw">file</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">path</span>,<span class="st">"data"</span>,<span class="st">"miRNA_all.RData"</span>))</pre></body></html></div>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co">### Downloading "Gene Expression Quantification". ###</span>

<span class="co">#rm(list=ls())</span>
<span class="co">#&lt;&lt;functions&gt;&gt;</span>

<span class="no">directory</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">path</span>,<span class="st">"data"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span>(<span class="no">directory</span>)

<span class="co"># Retrieving cancer types:</span>
<span class="no">project</span> <span class="kw">&lt;-</span> <span class="kw pkg">TCGAbiolinks</span><span class="kw ns">::</span><span class="fu">getGDCprojects</span>()$<span class="no">id</span>
<span class="no">project</span> <span class="kw">&lt;-</span> <span class="no">project</span>[<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">project</span>,<span class="kw">pattern</span><span class="kw">=</span><span class="st">"TCGA"</span>)]

<span class="co"># Downloading data:</span>
<span class="fu"><a href="https://rdrr.io/r/utils/memory.size.html">memory.limit</a></span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">16000</span>) <span class="co"># Activate virtual memory in system control!</span>
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="no">X</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">project</span>)){
    <span class="no">query</span> <span class="kw">&lt;-</span> <span class="kw pkg">TCGAbiolinks</span><span class="kw ns">::</span><span class="fu">GDCquery</span>(<span class="kw">project</span><span class="kw">=</span><span class="no">project</span>[<span class="no">i</span>],
                <span class="kw">data.category</span><span class="kw">=</span><span class="st">"Transcriptome Profiling"</span>,
                <span class="kw">data.type</span><span class="kw">=</span><span class="st">"Gene Expression Quantification"</span>,
                <span class="kw">workflow.type</span><span class="kw">=</span><span class="st">"HTSeq - Counts"</span>); <span class="fu"><a href="https://rdrr.io/r/base/gc.html">gc</a></span>()
    <span class="kw pkg">TCGAbiolinks</span><span class="kw ns">::</span><span class="fu">GDCdownload</span>(<span class="kw">query</span><span class="kw">=</span><span class="no">query</span>,<span class="kw">method</span><span class="kw">=</span><span class="st">"api"</span>,<span class="kw">directory</span><span class="kw">=</span><span class="no">directory</span>); <span class="fu"><a href="https://rdrr.io/r/base/gc.html">gc</a></span>()
    <span class="fu"><a href="https://rdrr.io/r/base/trace.html">trace</a></span>(<span class="kw pkg">TCGAbiolinks</span><span class="kw ns">:::</span><span class="no">readTranscriptomeProfiling</span>,<span class="kw">tracer</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span>(<span class="no">ignore.case</span><span class="kw">&lt;-</span><span class="fl">TRUE</span>)); <span class="fu"><a href="https://rdrr.io/r/base/gc.html">gc</a></span>()
    <span class="no">X</span><span class="kw">[[</span><span class="no">i</span>]] <span class="kw">&lt;-</span> <span class="kw pkg">TCGAbiolinks</span><span class="kw ns">::</span><span class="fu">GDCprepare</span>(<span class="no">query</span>,<span class="kw">directory</span><span class="kw">=</span><span class="no">directory</span>); <span class="fu"><a href="https://rdrr.io/r/base/gc.html">gc</a></span>()
    <span class="no">y</span><span class="kw">[[</span><span class="no">i</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">project</span>[<span class="no">i</span>],<span class="kw">times</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">X</span><span class="kw">[[</span><span class="no">i</span>]])); <span class="fu"><a href="https://rdrr.io/r/base/gc.html">gc</a></span>()
}

<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="kw">list</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"y"</span>,<span class="st">"X"</span>),<span class="kw">file</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">path</span>,<span class="st">"data"</span>,<span class="st">"gene_raw.RData"</span>))
<span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">path</span>,<span class="st">"data"</span>,<span class="st">"gene_raw.RData"</span>))

<span class="no">genes</span> <span class="kw">&lt;-</span> <span class="kw pkg">SummarizedExperiment</span><span class="kw ns">::</span><span class="fu">rowData</span>(<span class="no">X</span><span class="kw">[[</span><span class="fl">1</span>]])
<span class="no">mart</span> <span class="kw">&lt;-</span> <span class="kw pkg">biomaRt</span><span class="kw ns">::</span><span class="fu">useMart</span>(<span class="st">"ensembl"</span>,<span class="kw">dataset</span><span class="kw">=</span><span class="st">"hsapiens_gene_ensembl"</span>) <span class="co"># </span>
<span class="no">char</span> <span class="kw">&lt;-</span> <span class="kw pkg">biomaRt</span><span class="kw ns">::</span><span class="fu">getBM</span>(<span class="kw">attributes</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ensembl_gene_id"</span>,<span class="st">"chromosome_name"</span>,<span class="st">"transcript_start"</span>,<span class="st">"gene_biotype"</span>),<span class="kw">filters</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"biotype"</span>,<span class="st">"chromosome_name"</span>),<span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"protein_coding"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="fl">22</span>,<span class="st">"X"</span>)),<span class="kw">mart</span><span class="kw">=</span><span class="no">mart</span>)
<span class="no">select</span> <span class="kw">&lt;-</span> <span class="no">genes</span>$<span class="no">ensembl_gene_id</span>[<span class="no">genes</span>$<span class="no">ensembl_gene_id</span> <span class="kw">%in%</span> <span class="no">char</span>$<span class="no">ensembl_gene_id</span>]

<span class="no">X</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">X</span>,<span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="kw pkg">SummarizedExperiment</span><span class="kw ns">::</span><span class="fu">assays</span>(<span class="no">x</span>)$<span class="st">"HTSeq - Counts"</span>[<span class="no">select</span>,]))
<span class="no">X</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="kw">what</span><span class="kw">=</span><span class="no">rbind</span>,<span class="kw">args</span><span class="kw">=</span><span class="no">X</span>)
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="kw">what</span><span class="kw">=</span><span class="st">"c"</span>,<span class="kw">args</span><span class="kw">=</span><span class="no">y</span>)

<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="kw">list</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"y"</span>,<span class="st">"X"</span>),<span class="kw">file</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">path</span>,<span class="st">"data"</span>,<span class="st">"gene_all.RData"</span>))</pre></body></html></div>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co">### Downloading "Copy Number Variation". ###</span>

<span class="co">#rm(list=ls())</span>
<span class="co">#&lt;&lt;functions&gt;&gt;</span>

<span class="no">directory</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">path</span>,<span class="st">"data"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span>(<span class="no">directory</span>)

<span class="no">project</span> <span class="kw">&lt;-</span> <span class="kw pkg">TCGAbiolinks</span><span class="kw ns">::</span><span class="fu">getGDCprojects</span>()$<span class="no">id</span>
<span class="no">project</span> <span class="kw">&lt;-</span> <span class="no">project</span>[<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">project</span>,<span class="kw">pattern</span><span class="kw">=</span><span class="st">"TCGA"</span>)]

<span class="no">y</span> <span class="kw">&lt;-</span> <span class="no">X</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">project</span>)){
    <span class="no">query</span> <span class="kw">&lt;-</span> <span class="kw pkg">TCGAbiolinks</span><span class="kw ns">::</span><span class="fu">GDCquery</span>(<span class="kw">project</span><span class="kw">=</span><span class="no">project</span>[<span class="no">i</span>],
                <span class="kw">data.category</span><span class="kw">=</span><span class="st">"Copy Number Variation"</span>,
                <span class="kw">data.type</span><span class="kw">=</span><span class="st">"Masked Copy Number Segment"</span>)
    <span class="kw pkg">TCGAbiolinks</span><span class="kw ns">::</span><span class="fu">GDCdownload</span>(<span class="kw">query</span><span class="kw">=</span><span class="no">query</span>,<span class="kw">method</span><span class="kw">=</span><span class="st">"api"</span>,<span class="kw">directory</span><span class="kw">=</span><span class="no">directory</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/trace.html">trace</a></span>(<span class="kw pkg">TCGAbiolinks</span><span class="kw ns">:::</span><span class="no">readTranscriptomeProfiling</span>,<span class="kw">tracer</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span>(<span class="no">ignore.case</span><span class="kw">&lt;-</span><span class="fl">TRUE</span>))
    <span class="no">X</span><span class="kw">[[</span><span class="no">i</span>]] <span class="kw">&lt;-</span> <span class="kw pkg">TCGAbiolinks</span><span class="kw ns">::</span><span class="fu">GDCprepare</span>(<span class="no">query</span>,<span class="kw">directory</span><span class="kw">=</span><span class="no">directory</span>)
    <span class="no">y</span><span class="kw">[[</span><span class="no">i</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">project</span>[<span class="no">i</span>],<span class="kw">times</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">X</span><span class="kw">[[</span><span class="no">i</span>]]$<span class="no">Sample</span>))) <span class="co"># correct?</span>
}

<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="kw">list</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"y"</span>,<span class="st">"X"</span>),<span class="kw">file</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">path</span>,<span class="st">"data"</span>,<span class="st">"CNV_raw.RData"</span>))
<span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">path</span>,<span class="st">"data"</span>,<span class="st">"CNV_raw.RData"</span>),<span class="kw">verbose</span><span class="kw">=</span><span class="fl">TRUE</span>)

<span class="co"># Merging CNV data:</span>
<span class="no">Xs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="kw">what</span><span class="kw">=</span><span class="no">rbind</span>,<span class="kw">args</span><span class="kw">=</span><span class="no">X</span>) <span class="co"># sparse matrix</span>
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="kw">what</span><span class="kw">=</span><span class="st">"c"</span>,<span class="kw">args</span><span class="kw">=</span><span class="no">y</span>)
<span class="co">#table(Xs$Sample)</span>

<span class="co"># Prepare cutting.</span>
<span class="no">cut</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
<span class="no">cut</span>$<span class="no">chr</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="fl">22</span>,<span class="st">"X"</span>)
<span class="no">cut</span>$<span class="no">start</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">cut</span>$<span class="no">chr</span>,<span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">Xs</span>$<span class="no">Start</span>[<span class="no">Xs</span>$<span class="no">Chromosome</span><span class="kw">==</span><span class="no">x</span>]))
<span class="no">cut</span>$<span class="no">end</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">cut</span>$<span class="no">chr</span>,<span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">Xs</span>$<span class="no">End</span>[<span class="no">Xs</span>$<span class="no">Chromosome</span><span class="kw">==</span><span class="no">x</span>]))
<span class="no">cut</span>$<span class="no">length</span> <span class="kw">&lt;-</span> <span class="no">cut</span>$<span class="no">end</span>-<span class="no">cut</span>$<span class="no">start</span>
<span class="no">cut</span>$<span class="no">dist</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">cut</span>$<span class="no">length</span>)/<span class="fl">10000</span>
<span class="no">cut</span>$<span class="no">num</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">cut</span>$<span class="no">length</span>/<span class="no">cut</span>$<span class="no">dist</span>)

<span class="co"># Create covariates.</span>
<span class="no">cov</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
<span class="no">cov</span>$<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">cut</span>$<span class="no">num</span>)
<span class="no">cov</span>$<span class="no">chromosome</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">cut</span>$<span class="no">chr</span>,<span class="kw">function</span>(<span class="no">i</span>) <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">i</span>,<span class="kw">times</span><span class="kw">=</span><span class="no">cut</span>$<span class="no">num</span>[<span class="no">i</span>])))
<span class="no">cov</span>$<span class="no">location</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">cut</span>$<span class="no">chr</span>,<span class="kw">function</span>(<span class="no">i</span>) <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span><span class="kw">=</span><span class="no">cut</span>$<span class="no">start</span>[<span class="no">i</span>],<span class="kw">to</span><span class="kw">=</span><span class="no">cut</span>$<span class="no">end</span>[<span class="no">i</span>],<span class="kw">length.out</span><span class="kw">=</span><span class="no">cut</span>$<span class="no">num</span>[<span class="no">i</span>]))))
<span class="no">cov</span>$<span class="no">name</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">cov</span>$<span class="no">chromosome</span>,<span class="st">":"</span>,<span class="no">cov</span>$<span class="no">location</span>)

<span class="co"># Create indices for each covariate.</span>
<span class="no">index</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/integer.html">integer</a></span>()),<span class="kw">times</span><span class="kw">=</span><span class="no">cov</span>$<span class="no">p</span>)
<span class="no">pb</span> <span class="kw">&lt;-</span> <span class="kw pkg">utils</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/utils/txtProgressBar.html">txtProgressBar</a></span>(<span class="kw">min</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">max</span><span class="kw">=</span><span class="no">cov</span>$<span class="no">p</span>,<span class="kw">style</span><span class="kw">=</span><span class="fl">3</span>)
<span class="kw">for</span>(<span class="no">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="no">cov</span>$<span class="no">p</span>)){
    <span class="kw pkg">utils</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/utils/txtProgressBar.html">setTxtProgressBar</a></span>(<span class="kw">pb</span><span class="kw">=</span><span class="no">pb</span>,<span class="kw">value</span><span class="kw">=</span><span class="no">j</span>)
    <span class="no">index</span><span class="kw">[[</span><span class="no">j</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>((<span class="no">Xs</span>$<span class="no">Chromosome</span><span class="kw">==</span><span class="no">cov</span>$<span class="no">chromosome</span>[<span class="no">j</span>]) <span class="kw">&amp;</span>
        (<span class="no">Xs</span>$<span class="no">Start</span><span class="kw">&lt;=</span><span class="no">cov</span>$<span class="no">location</span>[<span class="no">j</span>]) <span class="kw">&amp;</span> (<span class="no">cov</span>$<span class="no">location</span>[<span class="no">j</span>]<span class="kw">&lt;=</span><span class="no">Xs</span>$<span class="no">End</span>)) <span class="co"># consider &lt;</span>
}

<span class="co"># Expand indices to matrix.</span>
<span class="no">X</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>,<span class="kw">nrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">Xs</span>$<span class="no">Sample</span>)),<span class="kw">ncol</span><span class="kw">=</span><span class="no">cov</span>$<span class="no">p</span>,
             <span class="kw">dimnames</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">Xs</span>$<span class="no">Sample</span>),<span class="no">cov</span>$<span class="no">name</span>))
<span class="kw">for</span>(<span class="no">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">index</span>)){
    <span class="no">mean</span> <span class="kw">&lt;-</span> <span class="no">Xs</span>$<span class="no">Segment_Mean</span>[<span class="no">index</span><span class="kw">[[</span><span class="no">j</span>]]]
    <span class="no">i</span> <span class="kw">&lt;-</span> <span class="no">Xs</span>$<span class="no">Sample</span>[<span class="no">index</span><span class="kw">[[</span><span class="no">j</span>]]]
    <span class="no">X</span>[<span class="no">i</span>,<span class="no">j</span>] <span class="kw">&lt;-</span> <span class="no">mean</span>
}

<span class="kw">if</span>(<span class="fl">FALSE</span>){ <span class="co"># test</span>
    <span class="no">sample</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">X</span>),<span class="kw">size</span><span class="kw">=</span><span class="fl">1</span>)
    <span class="no">covariate</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">X</span>),<span class="kw">size</span><span class="kw">=</span><span class="fl">1</span>)
    <span class="no">split</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span>(<span class="no">covariate</span>,<span class="kw">split</span><span class="kw">=</span><span class="st">":"</span>)<span class="kw">[[</span><span class="fl">1</span>]]
    <span class="no">a</span> <span class="kw">&lt;-</span> <span class="no">X</span>[<span class="no">sample</span>,<span class="no">covariate</span>]
    <span class="no">b</span> <span class="kw">&lt;-</span> <span class="no">Xs</span>$<span class="no">Segment_Mean</span>[(<span class="no">Xs</span>$<span class="no">Sample</span><span class="kw">==</span><span class="no">sample</span>) <span class="kw">&amp;</span> (<span class="no">Xs</span>$<span class="no">Chromosome</span><span class="kw">==</span><span class="no">split</span>[<span class="fl">1</span>]) <span class="kw">&amp;</span> (<span class="no">Xs</span>$<span class="no">Start</span><span class="kw">&lt;=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">split</span>[<span class="fl">2</span>])) <span class="kw">&amp;</span> (<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">split</span>[<span class="fl">2</span>]) <span class="kw">&lt;</span> <span class="no">Xs</span>$<span class="no">End</span>)]
    <span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span>(<span class="no">a</span><span class="kw">==</span><span class="no">b</span>)
}

<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="kw">list</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"y"</span>,<span class="st">"X"</span>,<span class="st">"index"</span>),<span class="kw">file</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">path</span>,<span class="st">"data"</span>,<span class="st">"CNV_all.RData"</span>))</pre></body></html></div>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co">### Extracting samples of interest. ###</span>

<span class="co">#rm(list=ls())</span>
<span class="co">#&lt;&lt;functions&gt;&gt;</span>

<span class="no">type</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"isoform"</span>,<span class="st">"miRNA"</span>,<span class="st">"CNV"</span>,<span class="st">"gene"</span>)

<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">type</span>)){
    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="no">type</span>[<span class="no">i</span>],<span class="st">"\n"</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">path</span>,<span class="st">"data"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">type</span>[<span class="no">i</span>],<span class="st">"_all.RData"</span>)),<span class="kw">verbose</span><span class="kw">=</span><span class="fl">TRUE</span>)

    <span class="co"># TCGA barcode</span>
    <span class="no">barcode</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">X</span>)
    <span class="no">code</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">barcode</span>,<span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span>(<span class="no">x</span>,<span class="kw">split</span><span class="kw">=</span><span class="st">"-"</span>))
    <span class="no">code</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="kw">what</span><span class="kw">=</span><span class="no">rbind</span>,<span class="kw">args</span><span class="kw">=</span><span class="no">code</span>))
    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">code</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"project"</span>,<span class="st">"TSS"</span>,<span class="st">"participant"</span>,<span class="st">"sample_vial"</span>,
                        <span class="st">"portion_analyte"</span>,<span class="st">"plate"</span>,<span class="st">"center"</span>)
    <span class="no">code</span>$<span class="no">sample</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">code</span>$<span class="no">sample_vial</span>,<span class="kw">start</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">stop</span><span class="kw">=</span><span class="fl">2</span>)
    <span class="no">code</span>$<span class="no">vial</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">code</span>$<span class="no">sample_vial</span>,<span class="kw">start</span><span class="kw">=</span><span class="fl">3</span>,<span class="kw">stop</span><span class="kw">=</span><span class="fl">3</span>)
    <span class="no">code</span>$<span class="no">portion</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">code</span>$<span class="no">portion_analyte</span>,<span class="kw">start</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">stop</span><span class="kw">=</span><span class="fl">2</span>)
    <span class="no">code</span>$<span class="no">analyte</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">code</span>$<span class="no">portion_analyte</span>,<span class="kw">start</span><span class="kw">=</span><span class="fl">3</span>,<span class="kw">stop</span><span class="kw">=</span><span class="fl">3</span>)
    <span class="no">code</span>$<span class="no">sample_vial</span> <span class="kw">&lt;-</span> <span class="no">code</span>$<span class="no">portion_analyte</span> <span class="kw">&lt;-</span> <span class="kw">NULL</span>

    <span class="co"># solid tumour (except blood for LAML)</span>
    <span class="no">solid</span> <span class="kw">&lt;-</span> (<span class="no">code</span>$<span class="no">sample</span><span class="kw">==</span><span class="st">"01"</span> <span class="kw">|</span> (<span class="no">y</span><span class="kw">==</span><span class="st">"TCGA-LAML"</span> <span class="kw">&amp;</span> <span class="no">code</span>$<span class="no">sample</span><span class="kw">==</span><span class="st">"03"</span>))
    <span class="no">X</span> <span class="kw">&lt;-</span> <span class="no">X</span>[<span class="no">solid</span>,]
    <span class="no">y</span> <span class="kw">&lt;-</span> <span class="no">y</span>[<span class="no">solid</span>]

    <span class="co"># unique samples</span>
    <span class="no">unique</span> <span class="kw">&lt;-</span> !<span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">X</span>),<span class="kw">start</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">stop</span><span class="kw">=</span><span class="fl">12</span>))
    <span class="no">X</span> <span class="kw">&lt;-</span> <span class="no">X</span>[<span class="no">unique</span>,]
    <span class="no">y</span> <span class="kw">&lt;-</span> <span class="no">y</span>[<span class="no">unique</span>]

    <span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="kw">list</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"y"</span>,<span class="st">"X"</span>),<span class="kw">file</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">path</span>,<span class="st">"data"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">type</span>[<span class="no">i</span>],<span class="st">"_sub.RData"</span>)))
}

<span class="co"># isoform: n=9'794, p=194'595, k=32</span>
<span class="co"># miRNA: n=9'794, p=1'881, k=32</span>
<span class="co"># gene: n=9'830, p=19'602, k=33</span>
<span class="co"># CNV: n=10'578, p=10'000, k=33</span>

<span class="co">## Understanding barcodes:</span>
<span class="co"># overview: https://wiki.nci.nih.gov/display/TCGA/TCGA+barcode</span>
<span class="co"># details: https://gdc.cancer.gov/resources-tcga-users/tcga-code-tables</span>

<span class="co">## Understanding replicate samples:</span>
<span class="co"># http://gdac.broadinstitute.org/runs/sampleReports/latest/READ_Replicate_Samples.html</span></pre></body></html></div>
</div>
<div id="analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#analysis" class="anchor"></a>Analysis</h1>
<p>Last data analysis started on 2019-04-12 (R version 3.5.3).</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="co">### Analysing the TCGA data. ###</span>

<span class="co">#rm(list=ls())</span>
<span class="co">#&lt;&lt;functions&gt;&gt;</span>

<span class="kw">for</span>(<span class="no">type</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"miRNA"</span>,<span class="st">"isoform"</span>,<span class="st">"CNV"</span>,<span class="st">"gene"</span>)){
  <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">Matrix</span>)
  <span class="kw">for</span>(<span class="no">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">207</span>,<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">528</span>))){
    <span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="no">k</span>); <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="no">k</span>,<span class="st">" "</span>)
    <span class="kw">if</span>(<span class="no">type</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"isoform"</span>,<span class="st">"miRNA"</span>) <span class="kw">&amp;</span> <span class="no">k</span> <span class="kw">&gt;</span> <span class="fl">496</span>){<span class="kw">next</span>}
    <span class="kw">if</span>(<span class="no">type</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CNV"</span>,<span class="st">"gene"</span>) <span class="kw">&amp;</span> <span class="no">k</span> <span class="kw">&gt;</span> <span class="fl">528</span>){<span class="kw">next</span>}

    <span class="co"># searching for missing cancer-cancer combinations</span>
    <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="kw">list</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>(),<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"k"</span>,<span class="st">"type"</span>,<span class="st">"path"</span>,<span class="st">"save"</span>,<span class="st">"file.exists"</span>,<span class="st">"file.remove"</span>))); <span class="fu"><a href="https://rdrr.io/r/base/gc.html">gc</a></span>()
    <span class="no">file0</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"results/"</span>,<span class="no">type</span>,<span class="st">"_start_"</span>,<span class="no">k</span>,<span class="st">".RData"</span>)
    <span class="no">file1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"results/"</span>,<span class="no">type</span>,<span class="st">"_loss_"</span>,<span class="no">k</span>,<span class="st">".RData"</span>)
    <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span>(<span class="no">file0</span>)<span class="kw">||</span><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span>(<span class="no">file1</span>)){<span class="kw">next</span>}
    <span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="kw">object</span><span class="kw">=</span><span class="no">k</span>,<span class="kw">file</span><span class="kw">=</span><span class="no">file0</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"data/"</span>,<span class="no">type</span>,<span class="st">"_sub.RData"</span>))

    <span class="co"># indicating the cancer-cancer combination</span>
    <span class="no">cancer</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substring</a></span>(<span class="kw">text</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">y</span>),<span class="kw">first</span><span class="kw">=</span><span class="fl">6</span>)
    <span class="no">comb</span> <span class="kw">&lt;-</span> <span class="kw pkg">utils</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/utils/combn.html">combn</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">cancer</span>,<span class="kw">m</span><span class="kw">=</span><span class="fl">2</span>)
    <span class="no">select</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"TCGA-"</span>,<span class="no">comb</span>[,<span class="no">k</span>])
    <span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">y</span><span class="kw">==</span><span class="no">select</span>[<span class="fl">1</span>],<span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">y</span><span class="kw">==</span><span class="no">select</span>[<span class="fl">2</span>],<span class="fl">0</span>,<span class="fl">NA</span>))
    <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="no">cancer</span>,<span class="no">select</span>)

    <span class="co"># removing other cancer types</span>
    <span class="no">cond</span> <span class="kw">&lt;-</span> !<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">y</span>)
    <span class="no">y</span> <span class="kw">&lt;-</span> <span class="no">y</span>[<span class="no">cond</span>]
    <span class="no">X</span> <span class="kw">&lt;-</span> <span class="no">X</span>[<span class="no">cond</span>,]
    <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="no">cond</span>)

    <span class="co"># pre-processing</span>
    <span class="kw">if</span>(<span class="no">type</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"isoform"</span>,<span class="st">"miRNA"</span>)){
      <span class="no">x</span> <span class="kw">&lt;-</span> <span class="kw pkg">palasso</span><span class="kw ns">:::</span><span class="fu"><a href="../reference/other.html">.prepare</a></span>(<span class="no">X</span>,<span class="kw">cutoff</span><span class="kw">=</span><span class="st">"zero"</span>)
    } <span class="kw">else</span> <span class="kw">if</span>(<span class="no">type</span><span class="kw">==</span><span class="st">"gene"</span>){
      <span class="no">x</span> <span class="kw">&lt;-</span> <span class="kw pkg">palasso</span><span class="kw ns">:::</span><span class="fu"><a href="../reference/other.html">.prepare</a></span>(<span class="no">X</span>,<span class="kw">cutoff</span><span class="kw">=</span><span class="st">"knee"</span>)
    } <span class="kw">else</span> <span class="kw">if</span>(<span class="no">type</span><span class="kw">==</span><span class="st">"CNV"</span>){
      <span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">X</span><span class="kw">=</span><span class="no">X</span>,<span class="kw">Z</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span>(<span class="no">X</span>))
      <span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">x</span>,<span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(<span class="no">x</span>))
      <span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(<span class="no">x</span>)$<span class="no">info</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">n</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">X</span>),<span class="kw">p</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">X</span>),<span class="kw">prop</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">x</span>$<span class="no">Z</span><span class="kw">==</span><span class="fl">0</span>))
    }
    <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="no">X</span>)

    <span class="co"># cross-validation</span>
    <span class="no">loss</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span>(<span class="kw">expr</span><span class="kw">=</span><span class="kw pkg">palasso</span><span class="kw ns">:::</span><span class="fu"><a href="../reference/other.html">.predict</a></span>(<span class="kw">y</span><span class="kw">=</span><span class="no">y</span>,<span class="kw">X</span><span class="kw">=</span><span class="no">x</span>,<span class="kw">nfolds.int</span><span class="kw">=</span><span class="fl">10</span>),<span class="kw">error</span><span class="kw">=</span><span class="kw">function</span>(<span class="no">e</span>) <span class="kw pkg">palasso</span><span class="kw ns">:::</span><span class="fu"><a href="../reference/other.html">.predict</a></span>(<span class="kw">y</span><span class="kw">=</span><span class="no">y</span>,<span class="kw">X</span><span class="kw">=</span><span class="no">x</span>,<span class="kw">nfolds.int</span><span class="kw">=</span><span class="fl">10</span>))

    <span class="co"># information</span>
    <span class="no">loss</span>$<span class="no">info</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">k</span><span class="kw">=</span><span class="no">k</span>,
                       <span class="kw">y0</span><span class="kw">=</span><span class="no">comb</span>[<span class="fl">2</span>,<span class="no">k</span>],
                       <span class="kw">y1</span><span class="kw">=</span><span class="no">comb</span>[<span class="fl">1</span>,<span class="no">k</span>],
                       <span class="kw">n0</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">y</span><span class="kw">==</span><span class="fl">0</span>),
                       <span class="kw">n1</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">y</span><span class="kw">==</span><span class="fl">1</span>),
                       <span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(<span class="no">x</span>)$<span class="no">info</span>,
                       <span class="no">loss</span>$<span class="no">info</span>)

    <span class="co"># refit</span>
    <span class="no">object</span> <span class="kw">&lt;-</span> <span class="kw pkg">palasso</span><span class="kw ns">::</span><span class="fu"><a href="../reference/palasso.html">palasso</a></span>(<span class="kw">y</span><span class="kw">=</span><span class="no">y</span>,<span class="kw">X</span><span class="kw">=</span><span class="no">x</span>,<span class="kw">nfolds</span><span class="kw">=</span><span class="fl">10</span>,<span class="kw">family</span><span class="kw">=</span><span class="st">"binomial"</span>,<span class="kw">standard</span><span class="kw">=</span><span class="fl">TRUE</span>,<span class="kw">elastic</span><span class="kw">=</span><span class="fl">TRUE</span>,<span class="kw">shrink</span><span class="kw">=</span><span class="fl">TRUE</span>)

    <span class="no">model</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">object</span>),<span class="st">"elastic"</span>,
               <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"paired."</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"adaptive"</span>,<span class="st">"standard"</span>,<span class="st">"combined"</span>)))

    <span class="kw">for</span>(<span class="no">max</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">10</span>,<span class="fl">50</span>,<span class="fl">Inf</span>)){
      <span class="no">temp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
      <span class="no">temp</span>$<span class="no">nzero</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">model</span><span class="kw">=</span><span class="no">model</span>,<span class="kw">x</span><span class="kw">=</span><span class="fl">NA</span>,<span class="kw">z</span><span class="kw">=</span><span class="fl">NA</span>)
      <span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">model</span>)){
        <span class="no">coef</span> <span class="kw">&lt;-</span> <span class="kw pkg">palasso</span><span class="kw ns">:::</span><span class="fu"><a href="../reference/methods.html">coef.palasso</a></span>(<span class="kw">object</span><span class="kw">=</span><span class="no">object</span>,<span class="kw">model</span><span class="kw">=</span><span class="no">model</span>[<span class="no">i</span>],<span class="kw">max</span><span class="kw">=</span><span class="no">max</span>)
        <span class="no">temp</span>$<span class="no">nzero</span>$<span class="no">x</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">coef</span>$<span class="no">x</span><span class="kw">!=</span><span class="fl">0</span>)
        <span class="no">temp</span>$<span class="no">nzero</span>$<span class="no">z</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">coef</span>$<span class="no">z</span><span class="kw">!=</span><span class="fl">0</span>)
      }
      <span class="no">temp</span>$<span class="no">select</span> <span class="kw">&lt;-</span> <span class="kw pkg">palasso</span><span class="kw ns">:::</span><span class="fu">subset.palasso</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">object</span>,<span class="kw">max</span><span class="kw">=</span><span class="no">max</span>,
                                              <span class="kw">model</span><span class="kw">=</span><span class="st">"paired.adaptive"</span>)$<span class="no">palasso</span>$<span class="no">select</span>
      <span class="no">temp</span>$<span class="no">weights</span> <span class="kw">&lt;-</span> <span class="kw pkg">palasso</span><span class="kw ns">:::</span><span class="fu"><a href="../reference/methods.html">weights.palasso</a></span>(<span class="kw">object</span><span class="kw">=</span><span class="no">object</span>,<span class="kw">max</span><span class="kw">=</span><span class="no">max</span>,
                                                <span class="kw">model</span><span class="kw">=</span><span class="st">"paired.adaptive"</span>)
      <span class="no">temp</span>$<span class="no">coef</span> <span class="kw">&lt;-</span> <span class="kw pkg">palasso</span><span class="kw ns">:::</span><span class="fu"><a href="../reference/methods.html">coef.palasso</a></span>(<span class="kw">object</span><span class="kw">=</span><span class="no">object</span>,<span class="kw">max</span><span class="kw">=</span><span class="no">max</span>,
                                          <span class="kw">model</span><span class="kw">=</span><span class="st">"paired.adaptive"</span>)
      <span class="no">loss</span><span class="kw">[[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"fit"</span>,<span class="no">max</span>)]] <span class="kw">&lt;-</span> <span class="no">temp</span>
    }

    <span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="kw">object</span><span class="kw">=</span><span class="no">loss</span>,<span class="kw">file</span><span class="kw">=</span><span class="no">file1</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/files.html">file.remove</a></span>(<span class="no">file0</span>)
  }

  <span class="no">index</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span>(),<span class="kw">pattern</span><span class="kw">=</span><span class="st">"sessionInfo"</span>))
  <span class="fu"><a href="https://rdrr.io/r/base/sink.html">sink</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"sessionInfo"</span>,<span class="no">index</span>+<span class="fl">1</span>,<span class="st">".txt"</span>))
  <span class="fu"><a href="https://rdrr.io/r/base/date.html">date</a></span>()
  <span class="kw pkg">utils</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()
  <span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/reexports.html">session_info</a></span>()
  <span class="fu"><a href="https://rdrr.io/r/base/sink.html">sink</a></span>()

}</pre></body></html></div>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="co"># The function &lt;&lt;collect&gt;&gt; loads all files from PATH including PATTERN in the file name, loads OBJECT into a list, and executes a function call.</span>
<span class="co">#&lt;&lt;functions&gt;&gt;</span>

<span class="co"># path: folder</span>
<span class="co"># pattern: character, or NULL (all files)</span>
<span class="co"># object: character vector, or NULL (all objects)</span>
<span class="co"># what: function call</span>

<span class="no">collect</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">path</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span>(),<span class="no">pattern</span><span class="kw">=</span><span class="st">""</span>,<span class="no">object</span><span class="kw">=</span><span class="kw">NULL</span>,<span class="no">what</span><span class="kw">=</span><span class="st">"rbind"</span>){
    <span class="no">OBJECT</span> <span class="kw">=</span> <span class="no">object</span>
    <span class="co"># identify files</span>
    <span class="no">files</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span>(<span class="no">path</span>)
    <span class="no">files</span> <span class="kw">&lt;-</span> <span class="no">files</span>[<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">files</span>,<span class="kw">pattern</span><span class="kw">=</span><span class="no">pattern</span>)]
    <span class="no">files</span> <span class="kw">&lt;-</span> <span class="no">files</span>[<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">files</span>,<span class="kw">pattern</span><span class="kw">=</span><span class="st">".RData"</span>)]
    <span class="no">number</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="kw">pattern</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">pattern</span>,<span class="st">"|.RData"</span>),<span class="kw">replacement</span><span class="kw">=</span><span class="st">""</span>,<span class="kw">x</span><span class="kw">=</span><span class="no">files</span>)
    <span class="no">files</span> <span class="kw">&lt;-</span> <span class="no">files</span>[<span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">number</span>))] <span class="co"># trial1</span>
    <span class="no">names</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="kw">pattern</span><span class="kw">=</span><span class="st">".RData"</span>,<span class="kw">replacement</span><span class="kw">=</span><span class="st">""</span>,<span class="kw">x</span><span class="kw">=</span><span class="no">files</span>) <span class="co"># trial1</span>
    <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">files</span>)<span class="kw">==</span><span class="fl">0</span>){<span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"Invalid datasets."</span>)}
    <span class="co"># load data</span>
    <span class="no">all</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
    <span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">files</span>)){
        <span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">path</span>,<span class="no">files</span>[<span class="no">i</span>]))
        <span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/parse.html">parse</a></span>(<span class="kw">text</span><span class="kw">=</span><span class="no">x</span>))
        <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(<span class="no">OBJECT</span>)){
            <span class="no">all</span><span class="kw">[[</span><span class="no">i</span>]] <span class="kw">&lt;-</span> <span class="no">x</span>
            <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">all</span>)[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="no">names</span>[<span class="no">i</span>]
        } <span class="kw">else</span> {
            <span class="kw">for</span>(<span class="no">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">OBJECT</span>)){
                <span class="no">all</span><span class="kw">[[</span><span class="no">OBJECT</span>[<span class="no">j</span>]]]<span class="kw">[[</span><span class="no">i</span>]] <span class="kw">&lt;-</span> <span class="no">x</span><span class="kw">[[</span><span class="no">OBJECT</span>[<span class="no">j</span>]]]
                <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">all</span><span class="kw">[[</span><span class="no">OBJECT</span>[<span class="no">j</span>]]])[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="no">names</span>[<span class="no">i</span>]
            }
        }
    }
    <span class="co"># fuse data</span>
    <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(<span class="no">OBJECT</span>)){
        <span class="no">all</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="kw">what</span><span class="kw">=</span><span class="no">what</span>,<span class="kw">args</span><span class="kw">=</span><span class="no">all</span>)
    } <span class="kw">else</span> {
        <span class="no">all</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">all</span>,<span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="kw">what</span><span class="kw">=</span><span class="no">what</span>,<span class="kw">args</span><span class="kw">=</span><span class="no">x</span>))
    }
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">all</span>)
}

<span class="no">LOSS</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
<span class="no">type</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"gene"</span>,<span class="st">"isoform"</span>,<span class="st">"miRNA"</span>,<span class="st">"CNV"</span>)
<span class="co">#type &lt;- "miRNA"</span>
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">type</span>)){
  <span class="no">LOSS</span><span class="kw">[[</span><span class="no">type</span>[<span class="no">i</span>]]] <span class="kw">&lt;-</span> <span class="fu">collect</span>(<span class="kw">path</span><span class="kw">=</span><span class="st">"results"</span>,
                             <span class="kw">pattern</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">type</span>[<span class="no">i</span>],<span class="st">"_loss_"</span>),
                             <span class="kw">object</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"deviance"</span>,<span class="st">"auc"</span>,<span class="st">"class"</span>,<span class="st">"info"</span>,
                                      <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"fit"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">10</span>,<span class="fl">50</span>,<span class="fl">Inf</span>))))
}
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">LOSS</span>)){
  <span class="kw">for</span>(<span class="no">j</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fl">3</span>){
    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">LOSS</span><span class="kw">[[</span><span class="no">i</span>]]<span class="kw">[[</span><span class="no">j</span>]])[<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">LOSS</span><span class="kw">[[</span><span class="no">i</span>]]<span class="kw">[[</span><span class="no">j</span>]])<span class="kw">==</span><span class="st">"paired.adaptive"</span>] <span class="kw">&lt;-</span> <span class="st">"paired"</span>
  }
}

<span class="co">#type &lt;- "gene"</span>
<span class="co">#a &lt;- LOSS[[type]]$deviance[rownames(LOSS[[type]]$deviance)=="10","paired"]</span>
<span class="co">#b &lt;- LOSS[[type]]$deviance[rownames(LOSS[[type]]$deviance)=="10","elastic"]</span>
<span class="co">#mean(a&lt;b)</span></pre></body></html></div>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="co">### Testing for significant differences. ###</span>

<span class="co">#rm(list=ls())</span>
<span class="co">#&lt;&lt;functions&gt;&gt;</span>
<span class="co">#&lt;&lt;collect&gt;&gt;</span>

<span class="no">row</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"gene"</span>,<span class="st">"isoform"</span>,<span class="st">"miRNA"</span>,<span class="st">"CNV"</span>)
<span class="no">col</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"10"</span>,<span class="st">"Inf"</span>)
<span class="no">lay</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"standard_x"</span>,<span class="st">"standard_z"</span>,<span class="st">"standard_xz"</span>,
         <span class="st">"adaptive_x"</span>,<span class="st">"adaptive_z"</span>,<span class="st">"adaptive_xz"</span>,
         <span class="st">"elastic"</span>) <span class="co"># added "elastic"</span>

<span class="no">M</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="fl">NA</span>,<span class="kw">dim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">row</span>),<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">col</span>),<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">lay</span>)),<span class="kw">dimnames</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">row</span>,<span class="no">col</span>,<span class="no">lay</span>))

<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">row</span>)){

  <span class="no">loss</span> <span class="kw">&lt;-</span> <span class="no">LOSS</span><span class="kw">[[</span><span class="no">row</span>[<span class="no">i</span>]]][<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"info"</span>,<span class="st">"deviance"</span>)]

  <span class="no">y0</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">loss</span>$<span class="no">info</span>$<span class="no">y0</span>)
  <span class="no">y1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">loss</span>$<span class="no">info</span>$<span class="no">y1</span>)
  <span class="no">cancer</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">y0</span>,<span class="no">y1</span>)))
  <span class="no">Z</span> <span class="kw">&lt;-</span> <span class="kw pkg">palasso</span><span class="kw ns">:::</span><span class="fu">.design</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">cancer</span>)

  <span class="kw">for</span>(<span class="no">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">col</span>)){

    <span class="co"># differences</span>
    <span class="no">cond</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">loss</span>$<span class="no">deviance</span>)<span class="kw">==</span><span class="no">col</span>[<span class="no">j</span>]

    <span class="kw">for</span>(<span class="no">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">lay</span>)){

      <span class="no">fill</span> <span class="kw">&lt;-</span> <span class="no">loss</span>$<span class="no">deviance</span>[<span class="no">cond</span>,<span class="no">lay</span>[<span class="no">k</span>]] - <span class="no">loss</span>$<span class="no">deviance</span>[<span class="no">cond</span>,<span class="st">"paired"</span>]
      <span class="no">X</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">NA</span>,<span class="kw">nrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">cancer</span>),<span class="kw">ncol</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">cancer</span>),
                  <span class="kw">dimnames</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">cancer</span>,<span class="no">cancer</span>))
      <span class="no">X</span>[<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">y0</span>,<span class="no">y1</span>)] <span class="kw">&lt;-</span> <span class="no">X</span>[<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">y1</span>,<span class="no">y0</span>)] <span class="kw">&lt;-</span> <span class="no">fill</span>
      <span class="no">X</span>[<span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">lower.tri</a></span>(<span class="no">X</span>)] <span class="kw">&lt;-</span> <span class="fl">NA</span>

      <span class="co"># p-values</span>
      <span class="no">pvalue</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>,<span class="kw">times</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">Z</span>))
      <span class="kw">for</span>(<span class="no">l</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">Z</span>))){
        <span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">X</span>[<span class="no">Z</span><span class="kw">==</span><span class="no">l</span>])
        <span class="kw">if</span>(<span class="no">col</span>[<span class="no">j</span>]<span class="kw">==</span><span class="st">"10"</span>){
          <span class="no">alternative</span> <span class="kw">&lt;-</span> <span class="st">"greater"</span> <span class="co"># Never use "two.sided"!</span>
        }
        <span class="kw">if</span>(<span class="no">col</span>[<span class="no">j</span>]<span class="kw">==</span><span class="st">"Inf"</span>){
          <span class="no">alternative</span> <span class="kw">&lt;-</span> <span class="st">"less"</span> <span class="co"># Never use "two.sided"!</span>
        }
        <span class="no">pvalue</span>[<span class="no">l</span>] <span class="kw">&lt;-</span> <span class="kw pkg">stats</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x</span>,<span class="kw">alternative</span><span class="kw">=</span><span class="no">alternative</span>,
                                 <span class="kw">exact</span><span class="kw">=</span><span class="fl">FALSE</span>)$<span class="no">p.value</span>
      }

      <span class="co"># Simes</span>
      <span class="no">M</span>[<span class="no">i</span>,<span class="no">j</span>,<span class="no">k</span>] <span class="kw">&lt;-</span> <span class="kw pkg">palasso</span><span class="kw ns">:::</span><span class="fu"><a href="../reference/dot-combine.html">.combine</a></span>(<span class="no">pvalue</span>,<span class="kw">method</span><span class="kw">=</span><span class="st">"simes"</span>)
    }
  }
}

<span class="co"># Table SIG: significance</span>
<span class="no">constraint</span> <span class="kw">&lt;-</span> <span class="st">"10"</span>
<span class="no">table</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="no">M</span>[,<span class="no">constraint</span>,<span class="fl">1</span>:<span class="fl">6</span>],<span class="kw">digits</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">scientific</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">table</span>))){
    <span class="kw">for</span>(<span class="no">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">table</span>))){
        <span class="kw">if</span>(<span class="no">M</span>[<span class="no">i</span>,<span class="no">constraint</span>,<span class="no">j</span>]<span class="kw">&gt;=</span><span class="fl">0.05</span>){
            <span class="no">table</span>[<span class="no">i</span>,<span class="no">j</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"{\\color{gray}{"</span>,<span class="no">table</span>[<span class="no">i</span>,<span class="no">j</span>],<span class="st">"}}"</span>)
        }
    }
}
<span class="no">one</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>,<span class="st">"\\text{standard}"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"\\text{adaptive}"</span>,<span class="st">""</span>)
<span class="no">two</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"\\text{"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>,<span class="st">"z"</span>,<span class="st">"xz"</span>,<span class="st">"x"</span>,<span class="st">"z"</span>,<span class="st">"xz"</span>),<span class="st">"}"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">table</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"\\text{"</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">table</span>),<span class="st">"}"</span>)
<span class="no">table</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="no">one</span>,<span class="no">two</span>,<span class="no">table</span>,<span class="kw">deparse.level</span><span class="kw">=</span><span class="fl">0</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">table</span>)[<span class="fl">1</span>] <span class="kw">&lt;-</span> <span class="st">"~"</span>
<span class="no">xtable</span> <span class="kw">&lt;-</span> <span class="kw pkg">xtable</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/xtable/man/xtable.html">xtable</a></span>(<span class="no">table</span>,<span class="kw">align</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"r"</span>,<span class="st">"|"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"|"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>))
<span class="kw pkg">xtable</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/xtable/man/print.xtable.html">print.xtable</a></span>(<span class="no">xtable</span>,<span class="kw">type</span><span class="kw">=</span><span class="st">"latex"</span>,<span class="kw">include.colnames</span><span class="kw">=</span><span class="fl">FALSE</span>,<span class="kw">sanitize.text.function</span><span class="kw">=</span><span class="no">identity</span>)</pre></body></html></div>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="co">### Comparison with elastic net. ###</span>
<span class="co">#rm(list=ls())</span>
<span class="co">#&lt;&lt;functions&gt;&gt;</span>
<span class="co">#&lt;&lt;collect&gt;&gt;</span>

<span class="no">row</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"gene"</span>,<span class="st">"isoform"</span>,<span class="st">"miRNA"</span>,<span class="st">"CNV"</span>)
<span class="no">col</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"10"</span>,<span class="st">"50"</span>,<span class="st">"Inf"</span>)
<span class="no">better</span> <span class="kw">&lt;-</span> <span class="no">worse</span> <span class="kw">&lt;-</span> <span class="no">less</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">NA</span>,<span class="kw">nrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">row</span>),<span class="kw">ncol</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">col</span>),
                 <span class="kw">dimnames</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">row</span>,<span class="no">col</span>))
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">row</span>)){
  <span class="kw">for</span>(<span class="no">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">col</span>)){
    <span class="co"># proportion of improvements (cross-validation)</span>
    <span class="no">cond</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">LOSS</span><span class="kw">[[</span><span class="no">row</span>[<span class="no">i</span>]]]$<span class="no">deviance</span>)<span class="kw">==</span><span class="no">col</span>[<span class="no">j</span>]
    <span class="no">loss</span> <span class="kw">&lt;-</span> <span class="no">LOSS</span><span class="kw">[[</span><span class="no">row</span>[<span class="no">i</span>]]]$<span class="no">deviance</span>[<span class="no">cond</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"paired"</span>,<span class="st">"elastic"</span>)]
    <span class="no">better</span>[<span class="no">i</span>,<span class="no">j</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">loss</span>[,<span class="st">"paired"</span>]<span class="kw">&lt;</span><span class="no">loss</span>[,<span class="st">"elastic"</span>]),<span class="kw">digits</span><span class="kw">=</span><span class="fl">2</span>)
    <span class="no">worse</span>[<span class="no">i</span>,<span class="no">j</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">loss</span>[,<span class="st">"paired"</span>]<span class="kw">&gt;</span><span class="no">loss</span>[,<span class="st">"elastic"</span>]),<span class="kw">digits</span><span class="kw">=</span><span class="fl">2</span>)
    <span class="co"># average difference in nzero (refitted models)</span>
    <span class="no">df_paired</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">LOSS</span><span class="kw">[[</span><span class="no">row</span>[<span class="no">i</span>]]]<span class="kw">[[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"fit"</span>,<span class="no">col</span>[<span class="no">j</span>])]],<span class="fl">1</span>,<span class="kw">function</span>(<span class="no">x</span>)   <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">x</span>$<span class="no">nzero</span>[<span class="no">x</span>$<span class="no">nzero</span>[,<span class="st">"model"</span>]<span class="kw">==</span><span class="st">"paired.adaptive"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>,<span class="st">"z"</span>)]))
    <span class="no">df_elastic</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">LOSS</span><span class="kw">[[</span><span class="no">row</span>[<span class="no">i</span>]]]<span class="kw">[[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"fit"</span>,<span class="no">col</span>[<span class="no">j</span>])]],<span class="fl">1</span>,<span class="kw">function</span>(<span class="no">x</span>)   <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">x</span>$<span class="no">nzero</span>[<span class="no">x</span>$<span class="no">nzero</span>[,<span class="st">"model"</span>]<span class="kw">==</span><span class="st">"elastic95"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>,<span class="st">"z"</span>)]))
    <span class="no">df_diff</span> <span class="kw">&lt;-</span> <span class="no">df_elastic</span>-<span class="no">df_paired</span>
    <span class="no">less</span>[<span class="no">i</span>,<span class="no">j</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">df_diff</span>),<span class="kw">digits</span><span class="kw">=</span><span class="fl">2</span>)
    <span class="co">#graphics::hist(df_diff,main=paste(row[i],col[j]),xlim=c(-1,1)*max(abs(df_diff)))</span>
  }
}
<span class="no">better</span>
<span class="no">worse</span>
<span class="no">less</span></pre></body></html></div>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="co">### Analysing the refitted models. ###</span>

<span class="co">#rm(list=ls())</span>
<span class="co">#&lt;&lt;functions&gt;&gt;</span>
<span class="co">#&lt;&lt;collect&gt;&gt;</span>

<span class="co"># Table SEL: selected model</span>
<span class="no">nzero</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"fit"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">Inf</span>))
<span class="no">model</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"standard_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>,<span class="st">"z"</span>,<span class="st">"xz"</span>)),
           <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"adaptive_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>,<span class="st">"z"</span>,<span class="st">"xz"</span>)),
           <span class="st">"between_xz"</span>,<span class="st">"within_xz"</span>)
<span class="no">type</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"gene"</span>,<span class="st">"isoform"</span>,<span class="st">"miRNA"</span>,<span class="st">"CNV"</span>)
<span class="no">table</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="fl">NA</span>,<span class="kw">dim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">nzero</span>),<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">model</span>),<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">type</span>)),
               <span class="kw">dimnames</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">nzero</span>,<span class="no">model</span>,<span class="no">type</span>))
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">nzero</span>)){
    <span class="kw">for</span>(<span class="no">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">model</span>)){
        <span class="kw">for</span>(<span class="no">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">type</span>)){
            <span class="no">sub</span> <span class="kw">&lt;-</span> <span class="no">LOSS</span><span class="kw">[[</span><span class="no">type</span>[<span class="no">k</span>]]]<span class="kw">[[</span><span class="no">nzero</span>[<span class="no">i</span>]]]
            <span class="no">table</span>[<span class="no">i</span>,<span class="no">j</span>,<span class="no">k</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">sub</span>[,<span class="st">"select"</span>]<span class="kw">==</span><span class="no">model</span>[<span class="no">j</span>])
        }
    }
}
<span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span>(<span class="no">table</span>[<span class="st">"fit10"</span>,,]) <span class="co"># CHECK WHETHER COMPLETE!</span>
<span class="no">table</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span>(<span class="no">table</span>[<span class="st">"fit10"</span>,,],<span class="kw">margin</span><span class="kw">=</span><span class="fl">2</span>),<span class="kw">digits</span><span class="kw">=</span><span class="fl">2</span>)
<span class="no">table</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">table</span>)
<span class="no">table</span> <span class="kw">&lt;-</span> <span class="no">table</span>[,<span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">table</span>,<span class="fl">2</span>,<span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span>(<span class="no">x</span><span class="kw">!=</span><span class="fl">0</span>))]
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">table</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"\\text{"</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">table</span>),<span class="st">"}"</span>)
<span class="no">xtable</span> <span class="kw">&lt;-</span> <span class="kw pkg">xtable</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/xtable/man/xtable.html">xtable</a></span>(<span class="no">table</span>,<span class="kw">align</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"r"</span>,<span class="st">"|"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>))
<span class="kw pkg">xtable</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/xtable/man/print.xtable.html">print.xtable</a></span>(<span class="no">xtable</span>,<span class="kw">type</span><span class="kw">=</span><span class="st">"latex"</span>,<span class="kw">include.colnames</span><span class="kw">=</span><span class="fl">FALSE</span>,<span class="kw">sanitize.text.function</span><span class="kw">=</span><span class="no">identity</span>)

<span class="co"># selected weights and covariates</span>
<span class="no">type</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"gene"</span>,<span class="st">"isoform"</span>,<span class="st">"miRNA"</span>,<span class="st">"CNV"</span>)
<span class="no">group</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>,<span class="st">"z"</span>)
<span class="no">model</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"standard_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>,<span class="st">"z"</span>,<span class="st">"xz"</span>)),
           <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"adaptive_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>,<span class="st">"z"</span>,<span class="st">"xz"</span>)),
           <span class="st">"paired.adaptive"</span>,<span class="st">"elastic"</span>) <span class="co"># added "elastic" , paste0("elastic",c(100,75,50,25))</span>
<span class="no">weights10</span> <span class="kw">&lt;-</span> <span class="no">weightsInf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">NA</span>,<span class="kw">nrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">group</span>),<span class="kw">ncol</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">type</span>),
                <span class="kw">dimnames</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">group</span>,<span class="no">type</span>))
<span class="no">coef10</span> <span class="kw">&lt;-</span> <span class="no">coefInf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="fl">NA</span>,<span class="kw">dim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">group</span>),<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">type</span>),<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">model</span>)),
               <span class="kw">dimnames</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">group</span>,<span class="no">type</span>,<span class="no">model</span>))
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">group</span>)){
    <span class="kw">for</span>(<span class="no">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">type</span>)){
        <span class="no">weights10</span>[,<span class="no">j</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowMeans</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">LOSS</span><span class="kw">[[</span><span class="no">type</span>[<span class="no">j</span>]]]$<span class="no">fit10</span>[,<span class="st">"weights"</span>],<span class="no">colMeans</span>))
        <span class="no">weightsInf</span>[,<span class="no">j</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowMeans</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">LOSS</span><span class="kw">[[</span><span class="no">type</span>[<span class="no">j</span>]]]$<span class="no">fitInf</span>[,<span class="st">"weights"</span>],<span class="no">colMeans</span>))
        <span class="kw">for</span>(<span class="no">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">model</span>)){
            <span class="no">coef10</span>[<span class="no">i</span>,<span class="no">j</span>,<span class="no">k</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">LOSS</span><span class="kw">[[</span><span class="no">type</span>[<span class="no">j</span>]]]$<span class="no">fit10</span>[,<span class="st">"nzero"</span>], <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">x</span>[<span class="no">x</span>$<span class="no">model</span><span class="kw">==</span><span class="no">model</span>[<span class="no">k</span>],<span class="no">group</span>[<span class="no">i</span>]])))
            <span class="no">coefInf</span>[<span class="no">i</span>,<span class="no">j</span>,<span class="no">k</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">LOSS</span><span class="kw">[[</span><span class="no">type</span>[<span class="no">j</span>]]]$<span class="no">fitInf</span>[,<span class="st">"nzero"</span>], <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">x</span>[<span class="no">x</span>$<span class="no">model</span><span class="kw">==</span><span class="no">model</span>[<span class="no">k</span>],<span class="no">group</span>[<span class="no">i</span>]])))
        }
    }
}
<span class="co"># coef10["x",,]+coef10["z",,]</span>


<span class="co"># with sparsity constraint</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span>(<span class="no">weights10</span>,<span class="kw">margin</span><span class="kw">=</span><span class="fl">2</span>),<span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span>(<span class="no">coef10</span>[,,<span class="st">"paired.adaptive"</span>],<span class="kw">margin</span><span class="kw">=</span><span class="fl">2</span>),<span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span>(<span class="no">coef10</span>[,,<span class="st">"paired.adaptive"</span>]),<span class="fl">2</span>)

<span class="co"># natural sparsity</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span>(<span class="no">weightsInf</span>,<span class="kw">margin</span><span class="kw">=</span><span class="fl">2</span>),<span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span>(<span class="no">coefInf</span>[,,<span class="st">"paired.adaptive"</span>],<span class="kw">margin</span><span class="kw">=</span><span class="fl">2</span>),<span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span>(<span class="no">coefInf</span>[,,<span class="st">"paired.adaptive"</span>]),<span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span>(<span class="no">coefInf</span>[,,<span class="st">"elastic"</span>])/<span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span>(<span class="no">coefInf</span>[,,<span class="st">"paired.adaptive"</span>]),<span class="fl">1</span>) <span class="co"># multiple nzero of elastic net and paired lasso</span>

<span class="co"># Table NSC: number of non-zero coefficients</span>
<span class="no">table</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">coefInf</span>[<span class="st">"x"</span>,,]+<span class="no">coefInf</span>[<span class="st">"z"</span>,,])
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">table</span>)[<span class="fl">7</span>] <span class="kw">&lt;-</span> <span class="st">"paired"</span>
<span class="no">one</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>,<span class="st">"\\text{standard}"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"\\text{adaptive}"</span>,<span class="st">""</span>,<span class="st">"\\text{paired}"</span>,<span class="st">"\\text{elastic}"</span>)
<span class="no">two</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"\\text{"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>,<span class="st">"z"</span>,<span class="st">"xz"</span>,<span class="st">"x"</span>,<span class="st">"z"</span>,<span class="st">"xz"</span>,<span class="st">"xz"</span>,<span class="st">"xz"</span>),<span class="st">"}"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">table</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"\\text{"</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">table</span>),<span class="st">"}"</span>)
<span class="no">table</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="no">one</span>,<span class="no">two</span>,<span class="no">table</span>,<span class="kw">deparse.level</span><span class="kw">=</span><span class="fl">0</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">table</span>)[<span class="fl">1</span>] <span class="kw">&lt;-</span> <span class="st">"~"</span>
<span class="no">xtable</span> <span class="kw">&lt;-</span> <span class="kw pkg">xtable</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/xtable/man/xtable.html">xtable</a></span>(<span class="no">table</span>,<span class="kw">align</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"r"</span>,<span class="st">"|"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"|"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"|"</span>,<span class="st">"c"</span>,<span class="st">"|"</span>,<span class="st">"c"</span>))
<span class="kw pkg">xtable</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/xtable/man/print.xtable.html">print.xtable</a></span>(<span class="no">xtable</span>,<span class="kw">type</span><span class="kw">=</span><span class="st">"latex"</span>,<span class="kw">include.colnames</span><span class="kw">=</span><span class="fl">FALSE</span>,<span class="kw">sanitize.text.function</span><span class="kw">=</span><span class="no">identity</span>)</pre></body></html></div>
</div>
<div id="figures" class="section level1">
<h1 class="hasAnchor">
<a href="#figures" class="anchor"></a>Figures</h1>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="co">### FIGURE CSW ###</span>

<span class="co">#rm(list=ls())</span>
<span class="co">#&lt;&lt;functions&gt;&gt;</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)
<span class="no">overfit</span> <span class="kw">&lt;-</span> <span class="fl">TRUE</span>

<span class="co"># simulate</span>
<span class="no">n</span> <span class="kw">&lt;-</span> <span class="fl">10</span>
<span class="no">cx</span> <span class="kw">&lt;-</span> <span class="kw pkg">stats</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span>(<span class="kw">n</span><span class="kw">=</span><span class="no">n</span>,<span class="kw">shape1</span><span class="kw">=</span><span class="fl">0.9</span>,<span class="kw">shape2</span><span class="kw">=</span><span class="fl">1</span>)
<span class="no">cz</span> <span class="kw">&lt;-</span> <span class="kw pkg">stats</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span>(<span class="kw">n</span><span class="kw">=</span><span class="no">n</span>,<span class="kw">shape1</span><span class="kw">=</span><span class="fl">0.4</span>,<span class="kw">shape2</span><span class="kw">=</span><span class="fl">0.9</span>)

<span class="co"># collection</span>
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()

<span class="co"># adaptive weights (X only)</span>
<span class="no">x</span><span class="kw">[[</span><span class="fl">1</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>,<span class="kw">times</span><span class="kw">=</span><span class="no">n</span>)
<span class="kw">if</span>(<span class="no">overfit</span>){<span class="no">x</span><span class="kw">[[</span><span class="fl">1</span>]] <span class="kw">&lt;-</span> <span class="no">cx</span>}
<span class="no">y</span><span class="kw">[[</span><span class="fl">1</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>,<span class="kw">times</span><span class="kw">=</span><span class="no">n</span>)

<span class="co"># adaptive weights (Z only)</span>
<span class="no">x</span><span class="kw">[[</span><span class="fl">2</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>,<span class="kw">times</span><span class="kw">=</span><span class="no">n</span>)
<span class="no">y</span><span class="kw">[[</span><span class="fl">2</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>,<span class="kw">times</span><span class="kw">=</span><span class="no">n</span>)
<span class="kw">if</span>(<span class="no">overfit</span>){<span class="no">y</span><span class="kw">[[</span><span class="fl">2</span>]] <span class="kw">&lt;-</span> <span class="no">cz</span>}

<span class="co"># adaptive weights (X and Z)</span>
<span class="no">x</span><span class="kw">[[</span><span class="fl">3</span>]] <span class="kw">&lt;-</span> <span class="no">y</span><span class="kw">[[</span><span class="fl">3</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0.5</span>,<span class="kw">times</span><span class="kw">=</span><span class="no">n</span>)
<span class="kw">if</span>(<span class="no">overfit</span>){<span class="no">x</span><span class="kw">[[</span><span class="fl">3</span>]] <span class="kw">&lt;-</span> <span class="no">cx</span>}
<span class="kw">if</span>(<span class="no">overfit</span>){<span class="no">y</span><span class="kw">[[</span><span class="fl">3</span>]] <span class="kw">&lt;-</span> <span class="no">cz</span>}

<span class="co"># within-pair weights</span>
<span class="no">x</span><span class="kw">[[</span><span class="fl">4</span>]] <span class="kw">&lt;-</span> <span class="no">cx</span>^<span class="fl">2</span>/(<span class="no">cx</span>+<span class="no">cz</span>)
<span class="no">y</span><span class="kw">[[</span><span class="fl">4</span>]] <span class="kw">&lt;-</span> <span class="no">cz</span>^<span class="fl">2</span>/(<span class="no">cx</span>+<span class="no">cz</span>)

<span class="co"># visualisation</span>
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">4</span>),<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>),<span class="kw">oma</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">0</span>))
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="fl">4</span>)){
    <span class="kw pkg">palasso</span><span class="kw ns">:::</span><span class="fu"><a href="../reference/plots.html">plot_pairs</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x</span><span class="kw">[[</span><span class="no">i</span>]],<span class="kw">y</span><span class="kw">=</span><span class="no">y</span><span class="kw">[[</span><span class="no">i</span>]],<span class="kw">lwd</span><span class="kw">=</span><span class="fl">4</span>)
    <span class="kw">if</span>(<span class="no">i</span><span class="kw">==</span><span class="fl">1</span>){
        <span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="kw">text</span><span class="kw">=</span><span class="st">"covariate pair"</span>,<span class="kw">side</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">line</span><span class="kw">=</span><span class="fl">1</span>)
    }
}</pre></body></html></div>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="co">### FIGURE DIA ###</span>

<span class="co">#rm(list=ls())</span>
<span class="co">#&lt;&lt;functions&gt;&gt;</span>

<span class="no">ellipse</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>,<span class="no">y</span>,<span class="no">a</span><span class="kw">=</span><span class="fl">0.2</span>,<span class="no">b</span><span class="kw">=</span><span class="fl">0.25</span>,<span class="no">border</span><span class="kw">=</span><span class="fl">NA</span>){
    <span class="no">n</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x</span>),<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">y</span>)))
    <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x</span>)<span class="kw">==</span><span class="fl">1</span>){<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">x</span>,<span class="kw">times</span><span class="kw">=</span><span class="no">n</span>)}
    <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">y</span>)<span class="kw">==</span><span class="fl">1</span>){<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">y</span>,<span class="kw">times</span><span class="kw">=</span><span class="no">n</span>)}
    <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">border</span>)<span class="kw">==</span><span class="fl">1</span>){<span class="no">border</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">border</span>,<span class="kw">times</span><span class="kw">=</span><span class="no">n</span>)}
    <span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="no">n</span>)){
        <span class="no">angle</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">to</span><span class="kw">=</span><span class="fl">2</span>*<span class="no">pi</span>,<span class="kw">length</span><span class="kw">=</span><span class="fl">100</span>)
        <span class="no">xs</span> <span class="kw">&lt;-</span> <span class="no">x</span>[<span class="no">i</span>] + <span class="no">a</span> * <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span>(<span class="no">angle</span>)
        <span class="no">ys</span> <span class="kw">&lt;-</span> <span class="no">y</span>[<span class="no">i</span>] + <span class="no">b</span> * <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span>(<span class="no">angle</span>)
        <span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">xs</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">ys</span>,<span class="kw">col</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html">grey</a></span>(<span class="fl">0.9</span>),<span class="kw">border</span><span class="kw">=</span><span class="no">border</span>[<span class="no">i</span>])
    }
}

<span class="no">cancer</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ACC"</span>,<span class="st">"BLCA"</span>,<span class="st">"BRCA"</span>,<span class="st">"UVM"</span>)
<span class="no">number</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">80</span>,<span class="fl">409</span>,<span class="fl">1078</span>,<span class="fl">80</span>)
<span class="no">col</span> <span class="kw">&lt;-</span> <span class="kw pkg">grDevices</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="kw">red</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">green</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">blue</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span><span class="kw">=</span><span class="fl">75</span>,<span class="kw">to</span><span class="kw">=</span><span class="fl">255</span>,<span class="kw">length.out</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">number</span>))),<span class="kw">maxColorValue</span><span class="kw">=</span><span class="fl">255</span>)

<span class="no">lwd</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fl">2</span>*<span class="no">number</span>)-<span class="fl">2</span>
<span class="no">lwd</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">pmax</a></span>(<span class="fl">5</span>*<span class="no">number</span>/<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">number</span>),<span class="fl">1</span>)
<span class="no">x1</span> <span class="kw">&lt;-</span> <span class="fl">1.3</span>; <span class="no">x2</span> <span class="kw">&lt;-</span> <span class="fl">2</span>; <span class="no">x3</span> <span class="kw">&lt;-</span> <span class="fl">3</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)

<span class="co"># first layer (bubble)</span>
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/frame.html">plot.new</a></span>()
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>))
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">plot.window</a></span>(<span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.1</span>,<span class="fl">3.3</span>),<span class="kw">ylim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">1.6</span>,<span class="fl">1.6</span>))
<span class="fu">ellipse</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x1</span>,<span class="kw">y</span><span class="kw">=</span><span class="fl">0</span>)
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x1</span>,<span class="kw">y</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">labels</span><span class="kw">=</span><span class="st">"TCGA"</span>,<span class="kw">font</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">adj</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>,<span class="fl">0</span>))
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x1</span>,<span class="kw">y</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">labels</span><span class="kw">=</span><span class="st">"n=9794"</span>,<span class="kw">adj</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>,<span class="fl">1.2</span>),<span class="kw">cex</span><span class="kw">=</span><span class="fl">0.9</span>)

<span class="co"># second layer (colon)</span>
<span class="no">y1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">to</span><span class="kw">=</span>-<span class="fl">1</span>,<span class="kw">length.out</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">cancer</span>)+<span class="fl">1</span>)
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x2</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">y1</span>[<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">cancer</span>)],<span class="kw">labels</span><span class="kw">=</span><span class="st">"..."</span>,<span class="kw">font</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">srt</span><span class="kw">=</span><span class="fl">90</span>)
<span class="no">y1</span> <span class="kw">&lt;-</span> <span class="no">y1</span>[-<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">cancer</span>)]

<span class="co"># first-second layer (connect)</span>
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span>(<span class="kw">x0</span><span class="kw">=</span><span class="no">x1</span>+<span class="fl">0.2</span>,<span class="kw">y0</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">x1</span><span class="kw">=</span><span class="no">x2</span>-<span class="fl">0.2</span>,<span class="kw">y1</span><span class="kw">=</span><span class="no">y1</span>,<span class="kw">lwd</span><span class="kw">=</span><span class="no">lwd</span>,<span class="kw">col</span><span class="kw">=</span><span class="no">col</span>)

<span class="co"># second layer (bubble)</span>
<span class="fu">ellipse</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x2</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">y1</span>,<span class="kw">a</span><span class="kw">=</span><span class="fl">0.2</span>,<span class="kw">b</span><span class="kw">=</span><span class="fl">0.2</span>)
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x2</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">y1</span>,<span class="kw">labels</span><span class="kw">=</span><span class="no">cancer</span>,<span class="kw">font</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">col</span><span class="kw">=</span><span class="no">col</span>,<span class="kw">adj</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>,<span class="fl">0</span>))
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x2</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">y1</span>,<span class="kw">labels</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"n="</span>,<span class="no">number</span>,<span class="st">""</span>),<span class="kw">adj</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>,<span class="fl">1.2</span>),<span class="kw">cex</span><span class="kw">=</span><span class="fl">0.9</span>)

<span class="no">comb</span> <span class="kw">&lt;-</span> <span class="kw pkg">utils</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/utils/combn.html">combn</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">y1</span>),<span class="kw">m</span><span class="kw">=</span><span class="fl">2</span>)

<span class="co"># third layer (colon)</span>
<span class="no">y2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span><span class="kw">=</span><span class="fl">1.5</span>,<span class="kw">to</span><span class="kw">=</span>-<span class="fl">1.5</span>,<span class="kw">length.out</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">comb</span>)+<span class="fl">1</span>)
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x3</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">y2</span>[<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">comb</span>)],<span class="kw">labels</span><span class="kw">=</span><span class="st">"..."</span>,<span class="kw">font</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">srt</span><span class="kw">=</span><span class="fl">90</span>)
<span class="no">y2</span> <span class="kw">&lt;-</span> <span class="no">y2</span>[-<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">comb</span>)]

<span class="co"># second-third layer (connect)</span>
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span>(<span class="kw">x0</span><span class="kw">=</span><span class="fl">2.2</span>,<span class="kw">y0</span><span class="kw">=</span><span class="no">y1</span>[<span class="no">comb</span>[<span class="fl">1</span>,]],<span class="kw">x1</span><span class="kw">=</span><span class="fl">2.7</span>,<span class="kw">y1</span><span class="kw">=</span><span class="no">y2</span>,<span class="kw">lwd</span><span class="kw">=</span><span class="no">lwd</span>[<span class="no">comb</span>[<span class="fl">1</span>,]],<span class="kw">col</span><span class="kw">=</span><span class="no">col</span>[<span class="no">comb</span>[<span class="fl">1</span>,]])
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span>(<span class="kw">x0</span><span class="kw">=</span><span class="fl">2.2</span>,<span class="kw">y0</span><span class="kw">=</span><span class="no">y1</span>[<span class="no">comb</span>[<span class="fl">2</span>,]],<span class="kw">x1</span><span class="kw">=</span><span class="fl">2.7</span>,<span class="kw">y1</span><span class="kw">=</span><span class="no">y2</span>,<span class="kw">lwd</span><span class="kw">=</span><span class="no">lwd</span>[<span class="no">comb</span>[<span class="fl">2</span>,]],<span class="kw">col</span><span class="kw">=</span><span class="no">col</span>[<span class="no">comb</span>[<span class="fl">2</span>,]])

<span class="co"># third layer (bubble)</span>
<span class="fu">ellipse</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x3</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">y2</span>,<span class="kw">a</span><span class="kw">=</span><span class="fl">0.3</span>,<span class="kw">b</span><span class="kw">=</span><span class="fl">0.22</span>)
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x3</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">y2</span>,<span class="kw">labels</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">cancer</span>[<span class="no">comb</span>[<span class="fl">1</span>,]],<span class="st">" "</span>),
               <span class="kw">font</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">col</span><span class="kw">=</span><span class="no">col</span>[<span class="no">comb</span>[<span class="fl">1</span>,]],<span class="kw">adj</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">0</span>))
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x3</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">y2</span>,<span class="kw">labels</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">" "</span>,<span class="no">cancer</span>[<span class="no">comb</span>[<span class="fl">2</span>,]]),
               <span class="kw">font</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">col</span><span class="kw">=</span><span class="no">col</span>[<span class="no">comb</span>[<span class="fl">2</span>,]],<span class="kw">adj</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">0</span>))
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x3</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">y2</span>,<span class="kw">labels</span><span class="kw">=</span><span class="st">":"</span>,<span class="kw">font</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">adj</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>,<span class="fl">0</span>))
<span class="no">labels</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">comb</span>,<span class="fl">2</span>,<span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">number</span>[<span class="no">x</span>]))
<span class="no">labels</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"n="</span>,<span class="no">labels</span>,<span class="st">""</span>)
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x3</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">y2</span>,<span class="kw">labels</span><span class="kw">=</span><span class="no">labels</span>,<span class="kw">adj</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>,<span class="fl">1.2</span>),<span class="kw">cex</span><span class="kw">=</span><span class="fl">0.9</span>)</pre></body></html></div>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="co">### FIGURE CLA ###</span>

<span class="co">#rm(list=ls())</span>
<span class="co">#&lt;&lt;functions&gt;&gt;</span>

<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">2</span>),<span class="kw">oma</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>),<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2.1</span>,<span class="fl">3.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))

<span class="kw">for</span>(<span class="no">type</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"gene"</span>,<span class="st">"isoform"</span>,<span class="st">"miRNA"</span>,<span class="st">"CNV"</span>)){

    <span class="no">loss</span> <span class="kw">&lt;-</span> <span class="no">LOSS</span><span class="kw">[[</span><span class="no">type</span>]][<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"deviance"</span>,<span class="st">"auc"</span>,<span class="st">"class"</span>)]
    <span class="no">choice</span> <span class="kw">&lt;-</span> <span class="st">"paired"</span>
    <span class="no">loss</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">loss</span>,<span class="kw">function</span>(<span class="no">x</span>) <span class="no">x</span>[,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"standard_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>,<span class="st">"z"</span>,<span class="st">"xz"</span>)),<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"adaptive_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>,<span class="st">"z"</span>,<span class="st">"xz"</span>)),<span class="no">choice</span>)])

    <span class="kw">for</span>(<span class="no">constraint</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"10"</span>)){ <span class="co"># c("5","10","Inf")</span>
        <span class="co"># change</span>
        <span class="no">sub</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">loss</span>,<span class="kw">function</span>(<span class="no">x</span>) <span class="no">x</span>[<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">x</span>)<span class="kw">==</span><span class="no">constraint</span>,])
        <span class="kw pkg">palasso</span><span class="kw ns">:::</span><span class="fu"><a href="../reference/plots.html">plot_score</a></span>(<span class="no">sub</span>$<span class="no">deviance</span>,<span class="kw">choice</span><span class="kw">=</span><span class="no">choice</span>)
        <span class="no">change</span> <span class="kw">&lt;-</span> <span class="no">sub</span>$<span class="no">deviance</span>[,<span class="fl">7</span>]-<span class="no">sub</span>$<span class="no">deviance</span>[,-<span class="fl">7</span>]
        <span class="kw pkg">palasso</span><span class="kw ns">:::</span><span class="fu"><a href="../reference/plots.html">plot_box</a></span>(<span class="no">change</span>,<span class="kw">ylab</span><span class="kw">=</span><span class="st">"change"</span>,<span class="kw">zero</span><span class="kw">=</span><span class="fl">TRUE</span>,<span class="kw">choice</span><span class="kw">=</span><span class="fl">NA</span>)
        <span class="co"># info</span>
        <span class="no">info</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
        <span class="no">info</span>$<span class="no">select</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">sub</span>$<span class="no">deviance</span>,<span class="fl">2</span>,<span class="no">median</span>)[-<span class="fl">7</span>]))
        <span class="no">info</span>$<span class="no">DEV_paired</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">sub</span>$<span class="no">deviance</span>[,<span class="no">choice</span>])
        <span class="no">info</span>$<span class="no">DEV_select</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">sub</span>$<span class="no">deviance</span>[,<span class="no">info</span>$<span class="no">select</span>])
        <span class="no">info</span>$<span class="no">improve</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">sub</span>$<span class="no">deviance</span>[,<span class="no">info</span>$<span class="no">select</span>]<span class="kw">&gt;</span><span class="no">sub</span>$<span class="no">deviance</span>[,<span class="no">choice</span>])
        <span class="no">info</span>$<span class="no">AUC_paired</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">sub</span>$<span class="no">auc</span>[,<span class="no">choice</span>])
        <span class="no">info</span>$<span class="no">CLASS_paired</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">sub</span>$<span class="no">class</span>[,<span class="no">choice</span>])
        <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="no">info</span>)) <span class="co"># important</span>
    }
}</pre></body></html></div>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="co">### FIGURE DEC ###</span>

<span class="co">#rm(list=ls())</span>
<span class="co">#&lt;&lt;functions&gt;&gt;</span>

<span class="co">#graphics::par(oma=c(1.0,1.0,0,0),mar=c(1.5,3.0,0.5,0.5),mfrow=c(1,1))</span>
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">oma</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.0</span>,<span class="fl">1.0</span>,<span class="fl">0</span>,<span class="fl">0</span>),<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.5</span>,<span class="fl">3.0</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>),<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">2</span>))

<span class="kw">for</span>(<span class="no">type</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"gene"</span>,<span class="st">"isoform"</span>,<span class="st">"miRNA"</span>,<span class="st">"CNV"</span>)){
    <span class="no">models</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"standard_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>,<span class="st">"z"</span>,<span class="st">"xz"</span>)),
                <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"adaptive_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>,<span class="st">"z"</span>,<span class="st">"xz"</span>)),<span class="st">"paired"</span>)
    <span class="no">constraint</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"3"</span>,<span class="st">"4"</span>,<span class="st">"5"</span>,<span class="st">"10"</span>,<span class="st">"15"</span>,<span class="st">"20"</span>,<span class="st">"25"</span>,<span class="st">"50"</span>,<span class="st">"Inf"</span>)

    <span class="no">loss</span> <span class="kw">&lt;-</span> <span class="no">LOSS</span><span class="kw">[[</span><span class="no">type</span>]][<span class="st">"deviance"</span>]

    <span class="no">loss</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">loss</span>,<span class="kw">function</span>(<span class="no">x</span>) <span class="no">x</span>[,<span class="no">models</span>])

    <span class="no">table</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">NA</span>,<span class="kw">nrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">constraint</span>),<span class="kw">ncol</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">models</span>),
                    <span class="kw">dimnames</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">constraint</span>,<span class="no">models</span>))
    <span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">constraint</span>)){
        <span class="no">sub</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">loss</span>,<span class="kw">function</span>(<span class="no">x</span>) <span class="no">x</span>[<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">x</span>)<span class="kw">==</span><span class="no">constraint</span>[<span class="no">i</span>],])
        <span class="no">table</span>[<span class="no">i</span>,] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">sub</span>$<span class="no">deviance</span>,<span class="fl">2</span>,<span class="no">median</span>)
    }

    <span class="co"># table &lt;- log(table)</span>
    <span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/frame.html">plot.new</a></span>()
    <span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">plot.window</a></span>(<span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">constraint</span>)),<span class="kw">ylim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span>(<span class="no">table</span>))
    <span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>()
    <span class="no">constraint</span>[<span class="no">constraint</span><span class="kw">==</span><span class="st">"Inf"</span>] <span class="kw">&lt;-</span> <span class="st">"n"</span>
    <span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="kw">side</span><span class="kw">=</span><span class="fl">2</span>)
    <span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="kw">side</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">at</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">constraint</span>),<span class="kw">labels</span><span class="kw">=</span><span class="no">constraint</span>,<span class="kw">tick</span><span class="kw">=</span><span class="fl">FALSE</span>,<span class="kw">line</span><span class="kw">=</span>-<span class="fl">1</span>)

    <span class="kw">for</span>(<span class="no">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>)){
        <span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">models</span>)){
            <span class="no">lty</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">i</span><span class="kw">%in%</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>),<span class="fl">3</span>,<span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">i</span><span class="kw">%in%</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>),<span class="fl">2</span>,<span class="fl">1</span>))
            <span class="no">col</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">i</span><span class="kw">==</span><span class="fl">7</span>,<span class="st">"#00007F"</span>,<span class="st">"#FF3535"</span>)
            <span class="no">pch</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">i</span><span class="kw">%in%</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">4</span>),<span class="st">"x"</span>,<span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">i</span><span class="kw">%in%</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">5</span>),<span class="st">"z"</span>,<span class="fl">1</span>))
            <span class="kw">if</span>(<span class="no">k</span><span class="kw">==</span><span class="fl">1</span>){
                <span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">table</span>[,<span class="no">i</span>],<span class="kw">col</span><span class="kw">=</span><span class="no">col</span>,<span class="kw">lty</span><span class="kw">=</span><span class="no">lty</span>,<span class="kw">lwd</span><span class="kw">=</span><span class="fl">2</span>)
                <span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="no">table</span>[,<span class="no">i</span>],<span class="kw">col</span><span class="kw">=</span><span class="st">"white"</span>,<span class="kw">pch</span><span class="kw">=</span><span class="fl">16</span>,<span class="kw">cex</span><span class="kw">=</span><span class="fl">1.2</span>)
            } <span class="kw">else</span> {
                <span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="no">table</span>[,<span class="no">i</span>],<span class="kw">col</span><span class="kw">=</span><span class="no">col</span>,<span class="kw">pch</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">font</span><span class="kw">=</span><span class="fl">2</span>)
            }
        }
    }
}
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span>(<span class="kw">ylab</span><span class="kw">=</span><span class="st">"deviance"</span>,<span class="kw">line</span><span class="kw">=</span><span class="fl">0.0</span>,<span class="kw">outer</span><span class="kw">=</span><span class="fl">TRUE</span>)
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span>(<span class="kw">xlab</span><span class="kw">=</span><span class="st">"sparsity constraint"</span>,<span class="kw">ylab</span><span class="kw">=</span><span class="st">"deviance"</span>,<span class="kw">line</span><span class="kw">=</span><span class="fl">0.0</span>,<span class="kw">outer</span><span class="kw">=</span><span class="fl">TRUE</span>)</pre></body></html></div>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="co">### FIGURE CNV ###</span>

<span class="co">#rm(list=ls())</span>
<span class="co">#&lt;&lt;functions&gt;&gt;</span>

<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">oma</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>),<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2.1</span>,<span class="fl">3.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>),<span class="kw">nrow</span><span class="kw">=</span><span class="fl">1</span>))

<span class="no">loss</span> <span class="kw">&lt;-</span> <span class="no">LOSS</span><span class="kw">[[</span><span class="no">type</span>]][<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"deviance"</span>,<span class="st">"auc"</span>,<span class="st">"class"</span>)]
<span class="no">loss</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">loss</span>,<span class="kw">function</span>(<span class="no">x</span>) <span class="no">x</span>[<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">x</span>)<span class="kw">==</span><span class="st">"10"</span>,])
<span class="no">model</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"standard_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>,<span class="st">"z"</span>,<span class="st">"xz"</span>)),
           <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"adaptive_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>,<span class="st">"z"</span>,<span class="st">"xz"</span>)))

<span class="no">diff</span> <span class="kw">&lt;-</span> <span class="no">loss</span>$<span class="no">auc</span>[,<span class="st">"paired"</span>]-<span class="no">loss</span>$<span class="no">auc</span>[,<span class="no">model</span>]
<span class="kw pkg">palasso</span><span class="kw ns">:::</span><span class="fu"><a href="../reference/plots.html">plot_box</a></span>(<span class="no">diff</span>,<span class="kw">zero</span><span class="kw">=</span><span class="fl">TRUE</span>,<span class="kw">invert</span><span class="kw">=</span><span class="fl">TRUE</span>,<span class="kw">ylab</span><span class="kw">=</span><span class="st">"change"</span>)
<span class="no">diff</span> <span class="kw">&lt;-</span> <span class="no">loss</span>$<span class="no">class</span>[,<span class="st">"paired"</span>]-<span class="no">loss</span>$<span class="no">class</span>[,<span class="no">model</span>]
<span class="kw pkg">palasso</span><span class="kw ns">:::</span><span class="fu"><a href="../reference/plots.html">plot_box</a></span>(<span class="no">diff</span>,<span class="kw">zero</span><span class="kw">=</span><span class="fl">TRUE</span>,<span class="kw">ylab</span><span class="kw">=</span><span class="st">"change"</span>)</pre></body></html></div>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="co">### FIGURE MAP ###</span>

<span class="co">#rm(list=ls())</span>
<span class="co">#&lt;&lt;functions&gt;&gt;</span>

<span class="no">loss</span> <span class="kw">&lt;-</span> <span class="no">LOSS</span><span class="kw">[[</span><span class="st">"CNV"</span>]][<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"info"</span>,<span class="st">"auc"</span>)]

<span class="no">cancer</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(<span class="no">loss</span>$<span class="no">info</span>$<span class="no">y0</span>),<span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(<span class="no">loss</span>$<span class="no">info</span>$<span class="no">y1</span>))))
<span class="no">X</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">NA</span>,<span class="kw">nrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">cancer</span>),<span class="kw">ncol</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">cancer</span>),<span class="kw">dimnames</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">cancer</span>,<span class="no">cancer</span>))
<span class="co">#Z &lt;- palasso:::.design(x=cancer)</span>
<span class="no">y0</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">loss</span>$<span class="no">info</span>$<span class="no">y0</span>)
<span class="no">y1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">loss</span>$<span class="no">info</span>$<span class="no">y1</span>)
<span class="no">X</span>[<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">y0</span>,<span class="no">y1</span>)] <span class="kw">&lt;-</span> <span class="no">X</span>[<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">y1</span>,<span class="no">y0</span>)] <span class="kw">&lt;-</span> <span class="no">loss</span>$<span class="no">auc</span>[<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">loss</span>$<span class="no">auc</span>)<span class="kw">==</span><span class="st">"10"</span>,<span class="st">"paired"</span>]

<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>,<span class="fl">3.0</span>,<span class="fl">3.0</span>,<span class="fl">0.5</span>))
<span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span>(<span class="no">X</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span>(<span class="no">X</span>),<span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"  "</span>,<span class="no">x</span>,<span class="st">"  "</span>))
<span class="kw pkg">palasso</span><span class="kw ns">:::</span><span class="fu"><a href="../reference/plots.html">plot_table</a></span>(<span class="kw">X</span><span class="kw">=</span><span class="no">X</span>,<span class="kw">margin</span><span class="kw">=</span>-<span class="fl">1</span>,<span class="kw">labels</span><span class="kw">=</span><span class="fl">FALSE</span>,<span class="kw">las</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">cex</span><span class="kw">=</span><span class="fl">0.7</span>)
<span class="co">#sort(rowMeans(X,na.rm=TRUE),decreasing=TRUE)[1:2] # keep!</span></pre></body></html></div>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="co">### FIGURE COM ###</span>

<span class="co"># 32 cancer types for isoform and miRNA</span>
<span class="co"># 33 cancer types for gene and CNV</span>

<span class="co">#rm(list=ls())</span>
<span class="co">#&lt;&lt;functions&gt;&gt;</span>

<span class="kw">for</span>(<span class="no">type</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"miRNA"</span>)){

<span class="no">cancer</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="no">LOSS</span><span class="kw">[[</span><span class="no">type</span>]]$<span class="no">info</span>[,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"y0"</span>,<span class="st">"y1"</span>)]))))

<span class="no">n</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">cancer</span>)
<span class="no">z</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw pkg">palasso</span><span class="kw ns">:::</span><span class="fu">.design</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">n</span>))
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="no">n</span>),<span class="kw">each</span><span class="kw">=</span><span class="no">n</span>)
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span><span class="kw">=</span><span class="no">n</span>,<span class="kw">to</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">by</span><span class="kw">=</span>-<span class="fl">1</span>),<span class="kw">times</span><span class="kw">=</span><span class="no">n</span>)

<span class="no">pch</span> <span class="kw">&lt;-</span> <span class="no">z</span>
<span class="no">pch</span>[<span class="no">pch</span><span class="kw">==</span><span class="fl">0</span>] <span class="kw">&lt;-</span> <span class="fl">NA</span>
<span class="no">pex</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"."</span>,<span class="st">"O"</span>,<span class="st">"*"</span>,<span class="st">"+"</span>,<span class="st">"o"</span>,<span class="st">"-"</span>,<span class="st">"'"</span>,<span class="st">"x"</span>)

<span class="co"># colour</span>
<span class="no">base</span> <span class="kw">&lt;-</span> <span class="kw pkg">grDevices</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span>(<span class="kw">colors</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'darkblue'</span>,<span class="st">'blue'</span>,<span class="st">'red'</span>,<span class="st">'darkred'</span>))(<span class="no">n</span>)

<span class="no">col</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>,<span class="kw">times</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">z</span>))
<span class="no">col</span>[<span class="no">z</span><span class="kw">==</span><span class="fl">0</span>] <span class="kw">&lt;-</span> <span class="st">"white"</span>
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="no">n</span>)){
    <span class="no">col</span>[<span class="no">z</span><span class="kw">==</span><span class="no">i</span>] <span class="kw">&lt;-</span> <span class="no">base</span>[<span class="no">i</span>]
}

<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>),<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">2</span>))
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/frame.html">plot.new</a></span>()
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">plot.window</a></span>(<span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="no">n</span>),<span class="kw">ylim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="no">n</span>))
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x</span>[<span class="no">pch</span><span class="kw">&lt;=</span><span class="fl">25</span>],<span class="kw">y</span><span class="kw">=</span><span class="no">y</span>[<span class="no">pch</span><span class="kw">&lt;=</span><span class="fl">25</span>],
                 <span class="kw">pch</span><span class="kw">=</span><span class="no">pch</span>[<span class="no">pch</span><span class="kw">&lt;=</span><span class="fl">25</span>],<span class="kw">col</span><span class="kw">=</span><span class="no">col</span>[<span class="no">pch</span><span class="kw">&lt;=</span><span class="fl">25</span>],<span class="kw">cex</span><span class="kw">=</span><span class="fl">0.9</span>)
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x</span>[<span class="no">pch</span><span class="kw">&gt;</span><span class="fl">25</span>],<span class="kw">y</span><span class="kw">=</span><span class="no">y</span>[<span class="no">pch</span><span class="kw">&gt;</span><span class="fl">25</span>],
                 <span class="kw">pch</span><span class="kw">=</span><span class="no">pex</span>[(<span class="no">pch</span>-<span class="fl">25</span>)[<span class="no">pch</span><span class="kw">&gt;</span><span class="fl">25</span>]],<span class="kw">col</span><span class="kw">=</span><span class="no">col</span>[<span class="no">pch</span><span class="kw">&gt;</span><span class="fl">25</span>],<span class="kw">cex</span><span class="kw">=</span><span class="fl">0.9</span>)
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span>(<span class="kw">x0</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">x1</span><span class="kw">=</span><span class="no">n</span>+<span class="fl">1</span>,<span class="kw">y0</span><span class="kw">=</span><span class="no">n</span>+<span class="fl">1</span>)
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span>(<span class="kw">x0</span><span class="kw">=</span><span class="no">n</span>+<span class="fl">1</span>,<span class="kw">y0</span><span class="kw">=</span><span class="no">n</span>+<span class="fl">1</span>,<span class="kw">y1</span><span class="kw">=</span><span class="fl">0</span>)
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span>(<span class="kw">x0</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">x1</span><span class="kw">=</span><span class="no">n</span>+<span class="fl">1</span>,<span class="kw">y0</span><span class="kw">=</span><span class="no">n</span>+<span class="fl">1</span>,<span class="kw">y1</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">lty</span><span class="kw">=</span><span class="fl">2</span>)

<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="kw">text</span><span class="kw">=</span><span class="no">cancer</span>,<span class="kw">side</span><span class="kw">=</span><span class="fl">3</span>,<span class="kw">at</span><span class="kw">=</span><span class="fl">1</span>:<span class="no">n</span>,<span class="kw">las</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">cex</span><span class="kw">=</span><span class="fl">0.7</span>)
<span class="kw pkg">graphics</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="kw">text</span><span class="kw">=</span><span class="no">cancer</span>,<span class="kw">side</span><span class="kw">=</span><span class="fl">4</span>,<span class="kw">at</span><span class="kw">=</span><span class="no">n</span>:<span class="fl">1</span>,<span class="kw">las</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">cex</span><span class="kw">=</span><span class="fl">0.7</span>)

}</pre></body></html></div>
<hr>
<hr>
<hr>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://rauschenberger.github.io">Armin Rauschenberger</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
